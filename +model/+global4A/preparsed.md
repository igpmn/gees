% [IrisToolbox] autogenerated preparsed model source code 03-Feb-2023 11:10:56
%
% * model-source/demography.md
% * model-source/households.md
% * model-source/production.md
% * model-source/monetary.md
% * model-source/fiscal.md
% * model-source/open.md
% * model-source/demography.md
% * model-source/households.md
% * model-source/production.md
% * model-source/monetary.md
% * model-source/fiscal.md
% * model-source/open.md
% * model-source/demography.md
% * model-source/households.md
% * model-source/production.md
% * model-source/monetary.md
% * model-source/fiscal.md
% * model-source/open.md
% * model-source/demography.md
% * model-source/households.md
% * model-source/production.md
% * model-source/monetary.md
% * model-source/fiscal.md
% * model-source/open.md
% * model-source/globals.md
% * model-source/wrapper-multiarea.md
% * model-source/commodity.md
% * model-source/trade.md
% * model-source/finance.md


!variables

    "Total population" us_nn
    "Total population, Y/Y" us_roc_nn
    "Area specific component in total population" us_nr
    "Working age population" us_nw
    "Labor force" us_nf


!log-variables !all-but


!parameters(:demography :steady)

    "S/S Population, Relative to global population component !! $\mathit{nr}_\ss$" us_ss_nr
    "S/S Share of working age population in total population !! $\tratio{\mathit{nw}}{\mathit{nn}}_\ss$" us_ss_nw_to_nn
    "S/S Labor participation rate !! $\tratio{\mathit{nf}}{\mathit{nw}}_\ss$" us_ss_nf_to_nw


!parameters(:demography :dynamic)

    "A/R Total population relative to global population component !! $\rho_\mathit{nr}$" us_rho_nr
    "A/R Share of working age population in total population !! $\rho_\mathit{nw}$" us_rho_nw
    "A/R Labor participation rate !! $\rho_\mathit{nf}$" us_rho_nf


!shocks

    "Shock to relative population component" us_shk_nr
    "Shock to share of working age population" us_shk_nw_to_nn
    "Shock to labor participation rate" us_shk_nf_to_nw


!equations

    "Total population relative to global population component"
    log(us_nr) = us_rho_nr * log(us_nr{-1}) + (1-us_rho_nr) * log(us_ss_nr) + us_shk_nr !! us_nr = us_ss_nr;


    "Total population"
    us_nn = us_nr * gg_nt;


    "Total population, Y/Y"
    us_roc_nn = us_nn / us_nn{-1} !! us_roc_nn = gg_ss_roc_nt;


    "Share of working age population"
    us_nw/us_nn = + us_rho_nw * us_nw{-1}/us_nn{-1} + (1-us_rho_nw) * us_ss_nw_to_nn + us_shk_nw_to_nn !! us_nw = us_ss_nw_to_nn * us_nn;


    "Labor participation rate"
    us_nf/us_nw = + us_rho_nf * us_nf{-1}/us_nw{-1} + (1-us_rho_nf) * us_ss_nf_to_nw + us_shk_nf_to_nw !! us_nf = us_ss_nf_to_nw * us_nw;


!variables(:households)

    "Private consumption" us_ch
    "Per-capita private consumption" us_ch_to_nn
    "Private consumption reference level" us_ref_ch_to_ch
    "Real discount factor" us_rdf
    "Per-worker labor supply" us_nh
    "Private investment" us_ih
    "Uncertainty in capital" us_zk
    "Uncertainty in profits" us_zy
    "Ex-post return on capital" us_rk
    "Production capital" us_k
    "Production capital services" us_uk
    "Portfolio of claims on production capital" us_kk
    "Household net worth" us_netw
    "Nominal wage rate" us_w
    "Real labor income" us_rli

    "Price of production capital" us_pk
    "Price of production capital services" us_pu
    "Real consumer wage rate" us_w_to_pc
    "Flexible nominal wage rate" us_ww

    "Nominal wage rate, Y/Y" us_roc_w
    "Household investment, Y/Y" us_roc_ih
    "Production capital, Y/Y" us_roc_k


!log-variables !all-but

    us_ref_ch_to_ch


!parameters(:households :steady)

    "S/S Uncertainty discount factor on capital !! $\mathit{zk}_\mathrm{ss}$" us_ss_zk
    "S/S Uncertainty discount factor on production cash flows !! $\mathit{zy}_\mathrm{ss}$" us_ss_zy
    "Household discount factor !! $\beta$" us_beta
    "Depreciation of production capital !! $\delta$" us_delta
    "Inverse elasticity of labor supply !! $\eta$" us_eta
    "Utility location parameter of labor supply !! $\eta_0$" us_eta0
    "Intercept in current wealth utility !! $\nu_0$" us_nu_0
    "Slope of current wealth utility !! $\nu_1$" us_nu_1
    "Level parameter in cost of utilization of production capital !! $\upsilon_0$" us_upsilon_0
    "Inverse elasticity of cost of utilization of production capital !! $\upsilon_1$" us_upsilon_1


!parameters(:households :dynamic)

    "A/R in real wage rate !! $\rho_w$" us_rho_w
    "A/R in uncertainty discount factor on capital !! $\rho_\mathit{zk}$" us_rho_zk
    "A/R in uncertainty discount factor on production cash flows !! $\rho_\mathit{zy}$" us_rho_zy
    "Point of reference in consuptions switch !! $\chi$" us_chi
    "Past consumption in reference consumption parameter !! $\chi_\mathit{ch}$" us_chi_ch
    "Current income in reference consumption parameter !! $\chi_\mathit{curr}$" us_chi_curr
    "Type 1 investment adjustment cost parameter !! $\xi_\mathit{ih,1}$" us_xi_ih1
    "Type 2 investment adjustment cost parameter !! $\xi_\mathit{ih,2}$" us_xi_ih2
    "Pressure relief valve for interest rate lower bound !! $\theta_\mathir{rh}$" us_theta_rh


!shocks(:households)

    "Shock to intertemporal preferences" us_shk_beta
    "Shock to private consumption" us_shk_ch
    "Shock to private investment" us_shk_ih
    "Shock to wage rate" us_shk_w
    "Shock to current income" us_shk_curr
    "Shock to uncertainty discount factor on capital" us_shk_zk
    "Shock to uncertainty discount factor on production cash flows" us_shk_zy


!equations(:households)


    "Optimal choice of household consumption"
    us_vh*us_pc*(us_ch - us_chi*us_ref_ch_to_ch*us_ch)*exp(-us_shk_ch) = us_nn*(1 - us_chi*&us_ref_ch_to_ch) !! us_vh*us_pc*us_ch = us_nn;

    "Point of reference in household consumption" 
    us_ref_ch_to_ch = [ us_chi_curr*((us_w*us_nh*us_nf - us_txls2_to_nc*us_pc*us_ch))/us_pc + us_chi_ch*us_ch{-1}*gg_ss_roc_a ] / us_ch;

    "Optimal choice of net position with local financial sector"
    us_vh = us_beta*us_vh{+1}*us_rh + us_nn/(us_pc*us_ch)*[ us_nu_1*(us_pc*us_ch/us_netw - us_nu_0) - gg_nu ] * exp(us_shk_beta) !! 1 = us_beta*us_rh/gg_ss_roc_a/us_ss_roc_pc + us_nu_1*us_nch_to_netw_minus_nu_0 - gg_nu;

    "Auxiliary equation for steady-state calibration of nu_0"
    us_nch_to_netw_minus_nu_0 = us_pc * us_ch / us_netw - us_nu_0;

    us_rdf = us_beta*us_vh{+1}*us_pc{+1}/(us_vh*us_pc);

    "Risk adjusted household rate"
    us_rh = us_r + us_theta_rh*(us_unc_r - us_r) + us_zh;

    "Current net worth of households"
    us_netw = us_kk + us_dg_to_ngdp*us_ngdp + us_nfa_to_ngdp*us_ngdp;

    "Uncertainty discount factor on capital"
    log(us_zk) = us_rho_zk*log(us_zk{-1}) + (1-us_rho_zk)*log(us_ss_zk) + us_shk_zk !! us_zk = us_ss_zk;

    "Uncertainty discount factor on production cash flows"
    log(us_zy) = us_rho_zy*log(us_zy{-1}) + (1-us_rho_zy)*log(us_ss_zy) + us_shk_zy !! us_zy = us_ss_zy;

    "Real labor income"
    us_rli = us_w*us_nh*us_nf / us_pc; 


    "Optimal choice of per-worker hours worked"
    us_vh * us_ww = us_eta0 * us_nh^us_eta;

    "Real consumer wage rate"
    us_w_to_pc = us_w / us_pc;

    "Real wage rigidities"
    log(us_w_to_pc) = + us_rho_w * [log(us_w_to_pc{-1}) + log(&us_roc_w/&us_roc_pc)] + (1-us_rho_w) * log(us_ww/us_pc) + us_shk_w !! us_w = us_ww;


    "Optimal choice of investment in local production capital"
    us_pk * exp(us_shk_ih) = us_pih*[ 1 + us_xi_ih1*(log(us_ih) - log((&us_ih/&us_k*&us_roc_k)*us_k{-1})) + us_xi_ih2*(log(us_ih/us_ih{-1}/&us_roc_ih) - us_beta*log(us_ih{+1}/us_ih/&us_roc_ih)) ] !! us_pk = us_pih;

    "Accumulation of production capital"
    us_k = (1-us_delta)*us_k{-1} + us_ih;

    "Definition of utilized production capital"
    us_uk = us_u * us_k;

    "Optimal choice of utilization rate of production capital"
    us_py * us_upsilon_0 * us_u^us_upsilon_1 = us_pu;

    "Auxiliary equation for steady-state calibration of upsilon_0"
    us_upsilon_1_py_to_pu = us_upsilon_0 * us_py / us_pu;

    "Ex-post return on capital"
    us_rk*us_pk{-1} = us_u{-1}*us_pu{-1}*us_rh{-1} + (1-us_delta)*us_pk;


        us_roc_w = us_w / us_w{-1};
    
        us_roc_ih = us_ih / us_ih{-1};
    
        us_roc_k = us_k / us_k{-1};


!variables(:production)

    "Area specific productivity component" us_ar
    "Shadow value of household budget constraing" us_vh
    "Price of private consumption" us_pc
    "Price of private investment" us_pih
    "Domestic intermediate inputs" us_yz
    "Stage T-3 output" us_y3
    "Stage T-2 output" us_y2
    "Stage T-1 output" us_y1
    "Stage T-0 output" us_y
    "Price of stage T-3 output" us_py3
    "Price of state T-2 output" us_py2
    "Price of state T-1 output" us_py1
    "Price of stage T-0 output" us_py0
    "Price of commodity input into production" us_pq

    "Commodity input into production" us_mq
    "Variable labor input into production" us_nv

    "Nominal GDP" us_ngdp
    "Real GDP index, Y/Y" us_roc_gdp
    "Per-capita real GDP index, Y/Y" us_roc_gdp_to_nn

    "Price of domestic production" us_py
    "Nominal household rate, LCY" us_rh

    "Price of final domestic output, Y/Y" us_roc_py
    "Price of final domestic output, Y/Y, Point of reference" us_ref_roc_py
    "Price of consumer goods, Y/Y" us_roc_pc
    "Utilization rate of production capital" us_u
    "Stage T-3 output, Y/Y" us_roc_y3
    "Variable labor, Y/Y" us_roc_nv

    "Auxiliary variable for steady-state calibration of upsilon_0" us_upsilon_1_py_to_pu
    "Auxiliary equation for steady-state calibration of nu_0" us_nch_to_netw_minus_nu_0


!log-variables !all-but

    us_zh, us_nch_to_netw_minus_nu_0


!parameters(:production :steady)

    "S/S Area specific productivity component !! $\mathit{ar}_\ss$" us_ss_ar

    "Share of overhead labor !! $\gamma_\mathit{n0}$" us_gamma_n0
    "Share of intermediate imports in stage T-3 production !! $\gamma_m$" us_gamma_m
    "Share of capital services in stage T-2 production !! $\gamma_\mathit{uk}$" us_gamma_uk
    "Share of commodity inputs in stage T-1 production !! $\gamma_q$" us_gamma_q
    "Share of roundabout intermediates in stage T-0 production !! $\gamma_\mathit{yz}$" us_gamma_yz

    "Monopoly power (markup) of local producers !! $\mu_\mathit{py}$" us_mu_py
    "Markup to cover overhead labor !! $\mu_{y3}$" us_mu_y3


!parameters(:production :dynamic)

    "Autoregression in area specific productivity component !! $\rho_\mathit{ar}$" us_rho_ar
    "Weight on S/S inflation in inflation indexation !! $\zeta_\mathit{py}$" us_zeta_py
    "Stage T-2 input factor adjustment cost parameter !! $\xi_{y2}$" us_xi_y2
    "Stage T-1 input factor adjustment cost parameter !! $\xi_{y1}$" us_xi_y1
    "Price adjustment cost parameters !! $\xi_\mathit{py}$" us_xi_py


!shocks(:production)

    "Shock to area specific productivity component" us_shk_ar
    "Shock to final price setting" us_shk_py


!equations(:production)


    "Area-specific relative productivity component"
    log(us_ar) = + us_rho_ar * log(us_ar{-1}) + (1 - us_rho_ar) * log(us_ss_ar) + us_shk_ar !! us_ar = us_ss_ar;


    "Definition of variable labor input"
    us_nv = (us_nh - us_gamma_n0*&us_nh) * us_nf;

    "Stage T-3 production function"
    us_y3 = (us_my/us_gamma_m)^us_gamma_m * ([us_ar * gg_a * us_nv]/(1-us_gamma_m))^(1-us_gamma_m);

    "Demand for intermediate imports"
    us_gamma_m * us_py3 * us_y3 = (us_pmm * gg_dmm) * us_my * [1 + us_xi_y3*((log(us_my/us_y3)-log(us_my{-1}/us_y3{-1}))-&us_rdf*(log(us_my{+1}/us_y3{+1})-log(us_my/us_y3)))] !! us_gamma_m * us_py3 * us_y3 = (us_pmm * gg_dmm) * us_my;

    "Demand for labor"
    (1-us_gamma_m) * us_py3 * us_y3 = us_mu_y3 * us_w * us_nv * [1 + us_xi_y3*((log(us_nv/us_y3)-log(us_nv{-1}/us_y3{-1})-log(&us_roc_nv/&us_roc_y3))-&us_rdf*(log(us_nv{+1}/us_y3{+1})-log(us_nv/us_y3)-log(&us_roc_nv/&us_roc_y3)))] !! (1-us_gamma_m) * us_py3 * us_y3 = us_mu_y3 * us_w * us_nv;


    us_y2 = (us_uk/us_gamma_uk)^us_gamma_uk * (us_y3/(1-us_gamma_uk))^(1-us_gamma_uk);

    us_gamma_uk * us_py2 * us_y2 = us_pu * us_uk * [1 + us_xi_y2*((log(us_uk/us_y2)-log(us_uk{-1}/us_y2{-1}))-&us_rdf*(log(us_uk{+1}/us_y2{+1})-log(us_uk/us_y2)))] !! us_gamma_uk * us_py2 * us_y2 = us_pu * us_uk;

    (1-us_gamma_uk) * us_py2 * us_y2 = us_py3 * us_y3 * [1 + us_xi_y2*((log(us_y3/us_y2)-log(us_y3{-1}/us_y2{-1}))-&us_rdf*(log(us_y3{+1}/us_y2{+1})-log(us_y3/us_y2)))] !! (1-us_gamma_uk) * us_py2 * us_y2 = us_py3 * us_y3;


    us_py1 = us_py2^(1 - us_gamma_q) * us_pq^us_gamma_q !! us_y1 = (us_y2/(1-us_gamma_q))^(1-us_gamma_q) * (us_mq/us_gamma_q)^us_gamma_q;

        (1-us_gamma_q) * &us_py1 * us_y1 = &us_py2 * us_y2 !! (1-us_gamma_q) * us_py1 * us_y1 = us_py2 * us_y2 ;

        (us_gamma_q) * &us_py1 * us_y1 = &us_pq * us_mq !! us_gamma_q * us_py1 * us_y1 = us_pq * us_mq ;


    us_y = us_y1;
    us_py0 = us_py1;
    us_yz = 1;


    us_mu_py*us_py0*exp(us_shk_py) = us_py*[1 + (us_mu_py-1)*us_xi_py*(log(us_roc_py/us_ref_roc_py) - us_beta*gg_zy*us_zy*log(us_roc_py{+1}/us_ref_roc_py{+1}))] !! us_py = us_mu_py * us_py0;

    us_ref_roc_py = us_roc_py{-1}^(1-us_zeta_py) * &us_roc_py^us_zeta_py;

    us_pc = us_py;
    us_pih = us_py;


    us_y = us_ch + us_cg + us_ih + us_yxx;


        us_roc_cg = us_cg / us_cg{-1};
    
        us_roc_pc = us_pc / us_pc{-1};
    
        us_roc_py = us_py / us_py{-1};
    
        us_roc_y3 = us_y3 / us_y3{-1};
    
        us_roc_nv = us_nv / us_nv{-1};


    "Per-capita private consumption"
    us_ch_to_nn = us_ch / us_nn;

    "Nominal GDP"
    us_ngdp = us_pc*us_ch + us_pih*us_ih + us_pc*us_cg + us_pxx*us_xx - us_pmm*us_mm + us_pq*(us_xq - us_mq);

    "Real GDP index, Y/Y"
    us_roc_gdp = + (us_pc*us_ch/us_ngdp + us_pc{-1}*us_ch{-1}/us_ngdp{-1})/2 * ((us_ch)/(us_ch{-1})) + (us_pih*us_ih/us_ngdp + us_pih{-1}*us_ih{-1}/us_ngdp{-1})/2 * ((us_ih)/(us_ih{-1})) + (us_pc*us_cg/us_ngdp + us_pc{-1}*us_cg{-1}/us_ngdp{-1})/2 * ((us_cg)/(us_cg{-1})) + (us_pxx*us_xx/us_ngdp + us_pxx{-1}*us_xx{-1}/us_ngdp{-1})/2 * ((us_xx)/(us_xx{-1})) - (us_pmm*us_mm/us_ngdp + us_pmm{-1}*us_mm{-1}/us_ngdp{-1})/2 * ((us_mm)/(us_mm{-1})) + (us_pq*us_xq/us_ngdp + us_pq{-1}*us_xq{-1}/us_ngdp{-1})/2 * ((us_xq)/(us_xq{-1})) - (us_pq*us_mq/us_ngdp + us_pq{-1}*us_mq{-1}/us_ngdp{-1})/2 * ((us_mq)/(us_mq{-1})) !! us_roc_gdp = gg_ss_roc_a * gg_ss_roc_nt;

    "Per-capita real GDP index, Y/Y"
    us_roc_gdp_to_nn = us_roc_gdp / us_roc_nn;


!postprocessor(:production)

    us_nch_to_ngdp = us_pc * us_ch / us_ngdp;
    us_nih_to_ngdp = us_pih * us_ih / us_ngdp;
    us_nkh_to_ngdp = us_pk * us_k / us_ngdp;
    us_curr_to_ngdp = ((us_w*us_nh*us_nf - us_txls2_to_nc*us_pc*us_ch)) / us_ngdp;
    us_gdp = us_gdp{-1} * us_roc_gdp;


!log-variables !all-but

    us_nch_to_ngdp
    us_nih_to_ngdp
    us_nkh_to_ngdp
    us_curr_to_ngdp


!variables(:monetary)

    "Nominal short-term rate, LCY" us_r
    "Monetary policy reaction term" us_react
    "Unconstrained nominal short-term rate, LCY" us_unc_r
    "Nominal short-term rate for interest parity, LCY" us_rip 


!parameters(:monetary :steady)

    "S/S Price of private consumption, Y/Y !! $\roc{\mathit{pc}}_\ss$" us_ss_roc_pc
    "Switch for lower bound on short-term rate !! $\mathit{floor}$" us_floor


!parameters(:monetary :dynamic)

    "A/R in policy rate !! $\rho_r$" us_rho_r 
    "Monetary policy reaction to CPI !! $\psi_\mathit{pc}$" us_psi_pc 
    "Monetary policy reaction to nominal exchange rate !! $\psi_e$" us_psi_e
    "Monetary policy reaction to real economic activity !! $\psi_\mathit{nh}$" us_psi_nh
    "Pressure relief valve for interest rate lower bound !! $\theta_\mathir{rip}$" us_theta_rip


!shocks(:monetary)

    "Shock to monetary policy reaction function" us_shk_r


!log-variables !all-but

    us_react


!equations(:monetary)

    "Monetary policy reaction function"
    log(us_unc_r) = + us_rho_r * log(us_r{-1}) + (1 - us_rho_r) * [ log(&us_unc_r) + us_react ] + us_shk_r !! us_pc = us_pc{-1} * us_ss_roc_pc;


    "Monetary policy reaction term"
    us_react = + us_psi_pc * (log(us_roc_pc{+1}) - log(us_ss_roc_pc)) + us_psi_e * (log(us_roc_e) - log(&us_roc_e)) + us_psi_nh * (log(us_nh{+1}) - log(&us_nh)) !! us_react = 0;


    "Zero floor constraint on policy rate"
    us_r = us_floor*max(1, us_unc_r) + (1-us_floor)*us_unc_r !! us_r = us_unc_r;

    us_rip = us_r + us_theta_rip*(us_unc_r - us_r) !! us_rip = us_r;


!variables

    "Government debt interest rate" us_rg
    "Government consumption" us_cg
    "Government debt to GDP ratio" us_dg_to_ngdp
    "Net lump-sum tax 1 to consumption ratio" us_txls1_to_nc
    "Net lump-sum tax 2 to consumption ratio" us_txls2_to_nc
    "Government consumption, Y/Y" us_roc_cg
    "Import tariff rate" us_trm


!log-variables !all-but

    us_txls1_to_nc, us_txls2_to_nc, us_dg_to_ngdp, us_trm


!parameters(:fiscal :steady)

    "S/S Government debt to GDP ratio !! $\tratio{\mathit{dg}}{\mathit{ngdp}}_\ss$" us_ss_dg_to_ngdp
    "S/S Government consumption to GDP ratio !! $\tratio{\mathit{ncg}}{\mathit{ngdp}}_\ss$" us_ss_ncg_to_ngdp
    "S/S General import tariff rate !! $\mathit{trm}_\ss$" us_ss_trm


!parameters(:fiscal :dynamic)

    "Response in government consumption to government debt !! $\tau_\mathit{cg}$" us_tau_cg
    "Response in type 1 lump-sum tax rate to government debt !! $\tau_{\mathit{txls},1}$" us_tau_txls1
    "Autoregression in government consumption !! $\rho_\mathit{cg}$" us_rho_cg
    "Autoregression in type 1 lump-sum tax rate !! $\rho_{\mathit{txls},1}$" us_rho_txls1
    "Autoregression in type 2 lump-sum tax rate !! $\rho_{\mathit{txls},2}$" us_rho_txls2
    "Autoregression in generate import tariff rate !! $\rho_\mathit{trm}$" us_rho_trm


!shocks

    "Shock to government consumption" us_shk_cg
    "Shock to type 1 lump-sum taxes" us_shk_txls1
    "Shock to type 2 lump-sum taxes" us_shk_txls2
    "Shock to general import tariff rate" us_shk_trm


!equations

    us_rg = us_r;

    
    "Dynamic fiscal budget constraint"
    us_dg_to_ngdp*us_ngdp = + us_rg{-1}*us_dg_to_ngdp{-1}*us_ngdp{-1} + us_pc*us_cg - (us_txls1_to_nc + us_txls2_to_nc) * us_pc*us_ch - (us_pmm - us_fob_pmm) * us_mm;


    "Fiscal reaction function for government consumption"
    log(us_cg) = + us_rho_cg * log(us_cg{-1}*&us_roc_cg) + (1 - us_rho_cg) * log(us_ss_ncg_to_ngdp*us_ngdp/us_pc) - us_tau_cg * (us_dg_to_ngdp{+1} - us_ss_dg_to_ngdp) + us_shk_cg !! us_pc*us_cg = us_ss_ncg_to_ngdp*us_ngdp;


    "Fiscal reaction function for type 1 net lump-sum taxes"
    us_txls1_to_nc = + us_rho_txls1 * us_txls1_to_nc{-1} + (1-us_rho_txls1) * &us_txls1_to_nc + us_tau_txls1 * (us_dg_to_ngdp{+1} - us_ss_dg_to_ngdp) + us_shk_txls1 !! us_dg_to_ngdp = us_ss_dg_to_ngdp;


    "Fiscal reaction function for type 2 net lump-sum taxes"
    us_txls2_to_nc = + us_rho_txls2*us_txls2_to_nc{-1} + us_shk_txls2 !! us_txls2_to_nc = 0;


    "Fiscal reaction function for import tariffs rate"
    us_trm = + us_rho_trm * us_trm{-1} + (1 - us_rho_trm) * us_ss_trm + us_shk_trm !! us_trm = us_ss_trm;


!variables(:open)

    "Non-commodity imports" us_mm
    "Price of non-commodity imports" us_pmm
    "Price of non-commodity imports, FOB" us_fob_pmm
    "Imports for non-commodity exports" us_mxx
    "Imports for domestic production" us_my

    "Domestic content of non-commodity exports" us_yxx
    "Non-commodity exports" us_xx
    "Commodity exports" us_xq
    "Price of non-commodity exports" us_pxx

    "Net foreign fixed-income assets to GDP Ratio" us_nfa_to_ngdp
    "Primary income rate on net foreign fixed-income assets" us_rnfa
    "Checksum for net foreign fixed-income assets to GDP ratio" us_nfa_to_ngdp_checksum
    "Nominal exchange rate" us_e
    "Expectations of nominal exchange rate" us_exp_e
    "Nominal Exchange Rate, Y/Y" us_roc_e
    "BOP CA corporate equity primary income to GDP ratio" us_bpceq_to_ngdp
    "BOP FA corporate equity transactions to GDP ratio" us_bpfeq_to_ngdp
    "Price of non-commodity exports, Reference ccy" us_pxx_rcy
    "Value of non-commodity exports, Reference ccy" us_nxx_rcy
    "Net claims of financial sector on households" us_bh_to_ngdp
    "Non-commodity imports to GDP ratio" us_nmm_to_ngdp
    "Non-commodity exports to GDP ratio" us_nxx_to_ngdp
    "Net commodity exports to GDP ratio" us_netxq_to_ngdp
    "Net non-commodity exports to GDP ratio" us_netxx_to_ngdp

    "Country credit risk" us_zh
    "Autonomous component in country credit risk" us_zh_aut


!log-variables !all-but

    us_nfa_to_ngdp
    us_nfa_to_ngdp_checksum
    us_bpfeq_to_ngdp
    us_bpceq_to_ngdp
    us_bh_to_ngdp
    us_nmm_to_ngdp
    us_nxx_to_ngdp
    us_netxq_to_ngdp
    us_netxx_to_ngdp
    us_zh_aut


!parameters(:open :steady)

    "Import intensity of non-commodity exports !! $\alpha$" us_alpha
    "Acceleration in exportable productivity !! $\gamma_\mathit{xx}$" us_gamma_xx
    "Elasticity of household risk function wrt NFA !! $\theta_1$" us_theta_1
    "Curvature of household risk function wrt NFA !! $\theta_2$" us_theta_2
    "Share of local commodity production in world commodity production !! $\lambda$" us_lambda
    "S/S Autonomous component in country credit risk !! $\mathit{zh}^\mathrm{aut}_\ss$" us_ss_zh_aut


!parameters(:open :dynamic)

    "A/R Autonomous component in country credit risk !! $\rho_{\mathit{zh}}^\mathrm{aut}$" us_rho_zh_aut
    "Weight on model-consistent expectations in exchange rate !! $\zeta_e$" us_zeta_e
    "Adjustment cost parameter in stage t-3 production !! $\xi_{y3}$" us_xi_y3


!shocks(:open)

    "Interest parity shock" us_shk_e
    "Shock to country credit risk" us_shk_zh
    "Shock to autonoumous component in country credit risk" us_shk_zh_aut


!equations(:open)


    "Distribution of non-commodity imports"
    us_mm = us_my + us_mxx;


    "Commodity endowment"
    us_xq = us_lambda * gg_q;

    "Commodity prices in local currency"
    us_pq = gg_pq * us_e;


    "Non-commodity export production function"
    us_xx = us_ar^us_gamma_xx * (us_yxx/(1-us_alpha))^(1-us_alpha) * (us_mxx/us_alpha)^us_alpha;

    "Demand for local content in export production"
    (1-us_alpha) * us_pxx * us_xx = us_py * us_yxx;

    "Demand for re-exports"
    us_alpha * us_pxx * us_xx = (us_pmm * gg_dmm) * us_mxx;


    "Balance of payments transactions"
    us_nfa_to_ngdp * us_ngdp - us_nfa_to_ngdp{-1} * us_ngdp{-1} = + us_bpfeq_to_ngdp * us_ngdp + (us_rnfa - 1) * us_nfa_to_ngdp{-1} * us_ngdp{-1} + us_bpceq_to_ngdp*us_ngdp + us_pxx * us_xx - us_fob_pmm * us_mm + us_netxq_to_ngdp * us_ngdp + us_nfa_to_ngdp_checksum * us_ngdp;

    "Local interest spread"
    us_zh = + us_zh_aut + us_theta_1 * (1/us_theta_2)*[ exp(-us_theta_2*us_nfa_to_ngdp*us_ngdp/(us_pk*us_k)) - 1 ] + us_shk_zh;

    "Autonomous component in local interest spread"
    us_zh_aut = + us_rho_zh_aut * us_zh_aut{-1} + (1 - us_rho_zh_aut) * us_ss_zh_aut + us_shk_zh_aut !! us_zh_aut = us_ss_zh_aut;


    "Net balance sheet of local financial sector"
    us_bh_to_ngdp + us_dg_to_ngdp + us_nfa_to_ngdp = 0;


    "Nominal Exchange Rate Expectations"
    us_exp_e = us_e{+1}^us_zeta_e * (us_e*&us_roc_e)^(1-us_zeta_e);


    us_roc_e = us_e / us_e{-1};


    "Price of non-commodity exports in reference currency"
    us_pxx_rcy = us_pxx / us_e;

    "Value of non-commodity exports in reference currency"
    us_nxx_rcy = us_pxx_rcy * us_xx;


    "Total imports to GDP ratio"
    us_nmm_to_ngdp = us_fob_pmm*us_mm / us_ngdp;
    us_nxx_to_ngdp = us_pxx*us_xx / us_ngdp;
    us_netxq_to_ngdp = us_pq*(us_xq - us_mq) / us_ngdp;
    us_netxx_to_ngdp = us_nxx_to_ngdp - us_nmm_to_ngdp;


!postprocessor

    us_nmxx_to_ngdp = us_fob_pmm * us_mxx / us_ngdp;


!log-variables !all-but

    us_nmm_to_ngdp
    us_nxx_to_ngdp
    us_nmxx_to_ngdp


!variables

    "Total population" ea_nn
    "Total population, Y/Y" ea_roc_nn
    "Area specific component in total population" ea_nr
    "Working age population" ea_nw
    "Labor force" ea_nf


!log-variables !all-but


!parameters(:demography :steady)

    "S/S Population, Relative to global population component !! $\mathit{nr}_\ss$" ea_ss_nr
    "S/S Share of working age population in total population !! $\tratio{\mathit{nw}}{\mathit{nn}}_\ss$" ea_ss_nw_to_nn
    "S/S Labor participation rate !! $\tratio{\mathit{nf}}{\mathit{nw}}_\ss$" ea_ss_nf_to_nw


!parameters(:demography :dynamic)

    "A/R Total population relative to global population component !! $\rho_\mathit{nr}$" ea_rho_nr
    "A/R Share of working age population in total population !! $\rho_\mathit{nw}$" ea_rho_nw
    "A/R Labor participation rate !! $\rho_\mathit{nf}$" ea_rho_nf


!shocks

    "Shock to relative population component" ea_shk_nr
    "Shock to share of working age population" ea_shk_nw_to_nn
    "Shock to labor participation rate" ea_shk_nf_to_nw


!equations

    "Total population relative to global population component"
    log(ea_nr) = ea_rho_nr * log(ea_nr{-1}) + (1-ea_rho_nr) * log(ea_ss_nr) + ea_shk_nr !! ea_nr = ea_ss_nr;


    "Total population"
    ea_nn = ea_nr * gg_nt;


    "Total population, Y/Y"
    ea_roc_nn = ea_nn / ea_nn{-1} !! ea_roc_nn = gg_ss_roc_nt;


    "Share of working age population"
    ea_nw/ea_nn = + ea_rho_nw * ea_nw{-1}/ea_nn{-1} + (1-ea_rho_nw) * ea_ss_nw_to_nn + ea_shk_nw_to_nn !! ea_nw = ea_ss_nw_to_nn * ea_nn;


    "Labor participation rate"
    ea_nf/ea_nw = + ea_rho_nf * ea_nf{-1}/ea_nw{-1} + (1-ea_rho_nf) * ea_ss_nf_to_nw + ea_shk_nf_to_nw !! ea_nf = ea_ss_nf_to_nw * ea_nw;


!variables(:households)

    "Private consumption" ea_ch
    "Per-capita private consumption" ea_ch_to_nn
    "Private consumption reference level" ea_ref_ch_to_ch
    "Real discount factor" ea_rdf
    "Per-worker labor supply" ea_nh
    "Private investment" ea_ih
    "Uncertainty in capital" ea_zk
    "Uncertainty in profits" ea_zy
    "Ex-post return on capital" ea_rk
    "Production capital" ea_k
    "Production capital services" ea_uk
    "Portfolio of claims on production capital" ea_kk
    "Household net worth" ea_netw
    "Nominal wage rate" ea_w
    "Real labor income" ea_rli

    "Price of production capital" ea_pk
    "Price of production capital services" ea_pu
    "Real consumer wage rate" ea_w_to_pc
    "Flexible nominal wage rate" ea_ww

    "Nominal wage rate, Y/Y" ea_roc_w
    "Household investment, Y/Y" ea_roc_ih
    "Production capital, Y/Y" ea_roc_k


!log-variables !all-but

    ea_ref_ch_to_ch


!parameters(:households :steady)

    "S/S Uncertainty discount factor on capital !! $\mathit{zk}_\mathrm{ss}$" ea_ss_zk
    "S/S Uncertainty discount factor on production cash flows !! $\mathit{zy}_\mathrm{ss}$" ea_ss_zy
    "Household discount factor !! $\beta$" ea_beta
    "Depreciation of production capital !! $\delta$" ea_delta
    "Inverse elasticity of labor supply !! $\eta$" ea_eta
    "Utility location parameter of labor supply !! $\eta_0$" ea_eta0
    "Intercept in current wealth utility !! $\nu_0$" ea_nu_0
    "Slope of current wealth utility !! $\nu_1$" ea_nu_1
    "Level parameter in cost of utilization of production capital !! $\upsilon_0$" ea_upsilon_0
    "Inverse elasticity of cost of utilization of production capital !! $\upsilon_1$" ea_upsilon_1


!parameters(:households :dynamic)

    "A/R in real wage rate !! $\rho_w$" ea_rho_w
    "A/R in uncertainty discount factor on capital !! $\rho_\mathit{zk}$" ea_rho_zk
    "A/R in uncertainty discount factor on production cash flows !! $\rho_\mathit{zy}$" ea_rho_zy
    "Point of reference in consuptions switch !! $\chi$" ea_chi
    "Past consumption in reference consumption parameter !! $\chi_\mathit{ch}$" ea_chi_ch
    "Current income in reference consumption parameter !! $\chi_\mathit{curr}$" ea_chi_curr
    "Type 1 investment adjustment cost parameter !! $\xi_\mathit{ih,1}$" ea_xi_ih1
    "Type 2 investment adjustment cost parameter !! $\xi_\mathit{ih,2}$" ea_xi_ih2
    "Pressure relief valve for interest rate lower bound !! $\theta_\mathir{rh}$" ea_theta_rh


!shocks(:households)

    "Shock to intertemporal preferences" ea_shk_beta
    "Shock to private consumption" ea_shk_ch
    "Shock to private investment" ea_shk_ih
    "Shock to wage rate" ea_shk_w
    "Shock to current income" ea_shk_curr
    "Shock to uncertainty discount factor on capital" ea_shk_zk
    "Shock to uncertainty discount factor on production cash flows" ea_shk_zy


!equations(:households)


    "Optimal choice of household consumption"
    ea_vh*ea_pc*(ea_ch - ea_chi*ea_ref_ch_to_ch*ea_ch)*exp(-ea_shk_ch) = ea_nn*(1 - ea_chi*&ea_ref_ch_to_ch) !! ea_vh*ea_pc*ea_ch = ea_nn;

    "Point of reference in household consumption" 
    ea_ref_ch_to_ch = [ ea_chi_curr*((ea_w*ea_nh*ea_nf - ea_txls2_to_nc*ea_pc*ea_ch))/ea_pc + ea_chi_ch*ea_ch{-1}*gg_ss_roc_a ] / ea_ch;

    "Optimal choice of net position with local financial sector"
    ea_vh = ea_beta*ea_vh{+1}*ea_rh + ea_nn/(ea_pc*ea_ch)*[ ea_nu_1*(ea_pc*ea_ch/ea_netw - ea_nu_0) - gg_nu ] * exp(ea_shk_beta) !! 1 = ea_beta*ea_rh/gg_ss_roc_a/ea_ss_roc_pc + ea_nu_1*ea_nch_to_netw_minus_nu_0 - gg_nu;

    "Auxiliary equation for steady-state calibration of nu_0"
    ea_nch_to_netw_minus_nu_0 = ea_pc * ea_ch / ea_netw - ea_nu_0;

    ea_rdf = ea_beta*ea_vh{+1}*ea_pc{+1}/(ea_vh*ea_pc);

    "Risk adjusted household rate"
    ea_rh = ea_r + ea_theta_rh*(ea_unc_r - ea_r) + ea_zh;

    "Current net worth of households"
    ea_netw = ea_kk + ea_dg_to_ngdp*ea_ngdp + ea_nfa_to_ngdp*ea_ngdp;

    "Uncertainty discount factor on capital"
    log(ea_zk) = ea_rho_zk*log(ea_zk{-1}) + (1-ea_rho_zk)*log(ea_ss_zk) + ea_shk_zk !! ea_zk = ea_ss_zk;

    "Uncertainty discount factor on production cash flows"
    log(ea_zy) = ea_rho_zy*log(ea_zy{-1}) + (1-ea_rho_zy)*log(ea_ss_zy) + ea_shk_zy !! ea_zy = ea_ss_zy;

    "Real labor income"
    ea_rli = ea_w*ea_nh*ea_nf / ea_pc; 


    "Optimal choice of per-worker hours worked"
    ea_vh * ea_ww = ea_eta0 * ea_nh^ea_eta;

    "Real consumer wage rate"
    ea_w_to_pc = ea_w / ea_pc;

    "Real wage rigidities"
    log(ea_w_to_pc) = + ea_rho_w * [log(ea_w_to_pc{-1}) + log(&ea_roc_w/&ea_roc_pc)] + (1-ea_rho_w) * log(ea_ww/ea_pc) + ea_shk_w !! ea_w = ea_ww;


    "Optimal choice of investment in local production capital"
    ea_pk * exp(ea_shk_ih) = ea_pih*[ 1 + ea_xi_ih1*(log(ea_ih) - log((&ea_ih/&ea_k*&ea_roc_k)*ea_k{-1})) + ea_xi_ih2*(log(ea_ih/ea_ih{-1}/&ea_roc_ih) - ea_beta*log(ea_ih{+1}/ea_ih/&ea_roc_ih)) ] !! ea_pk = ea_pih;

    "Accumulation of production capital"
    ea_k = (1-ea_delta)*ea_k{-1} + ea_ih;

    "Definition of utilized production capital"
    ea_uk = ea_u * ea_k;

    "Optimal choice of utilization rate of production capital"
    ea_py * ea_upsilon_0 * ea_u^ea_upsilon_1 = ea_pu;

    "Auxiliary equation for steady-state calibration of upsilon_0"
    ea_upsilon_1_py_to_pu = ea_upsilon_0 * ea_py / ea_pu;

    "Ex-post return on capital"
    ea_rk*ea_pk{-1} = ea_u{-1}*ea_pu{-1}*ea_rh{-1} + (1-ea_delta)*ea_pk;


        ea_roc_w = ea_w / ea_w{-1};
    
        ea_roc_ih = ea_ih / ea_ih{-1};
    
        ea_roc_k = ea_k / ea_k{-1};


!variables(:production)

    "Area specific productivity component" ea_ar
    "Shadow value of household budget constraing" ea_vh
    "Price of private consumption" ea_pc
    "Price of private investment" ea_pih
    "Domestic intermediate inputs" ea_yz
    "Stage T-3 output" ea_y3
    "Stage T-2 output" ea_y2
    "Stage T-1 output" ea_y1
    "Stage T-0 output" ea_y
    "Price of stage T-3 output" ea_py3
    "Price of state T-2 output" ea_py2
    "Price of state T-1 output" ea_py1
    "Price of stage T-0 output" ea_py0
    "Price of commodity input into production" ea_pq

    "Commodity input into production" ea_mq
    "Variable labor input into production" ea_nv

    "Nominal GDP" ea_ngdp
    "Real GDP index, Y/Y" ea_roc_gdp
    "Per-capita real GDP index, Y/Y" ea_roc_gdp_to_nn

    "Price of domestic production" ea_py
    "Nominal household rate, LCY" ea_rh

    "Price of final domestic output, Y/Y" ea_roc_py
    "Price of final domestic output, Y/Y, Point of reference" ea_ref_roc_py
    "Price of consumer goods, Y/Y" ea_roc_pc
    "Utilization rate of production capital" ea_u
    "Stage T-3 output, Y/Y" ea_roc_y3
    "Variable labor, Y/Y" ea_roc_nv

    "Auxiliary variable for steady-state calibration of upsilon_0" ea_upsilon_1_py_to_pu
    "Auxiliary equation for steady-state calibration of nu_0" ea_nch_to_netw_minus_nu_0


!log-variables !all-but

    ea_zh, ea_nch_to_netw_minus_nu_0


!parameters(:production :steady)

    "S/S Area specific productivity component !! $\mathit{ar}_\ss$" ea_ss_ar

    "Share of overhead labor !! $\gamma_\mathit{n0}$" ea_gamma_n0
    "Share of intermediate imports in stage T-3 production !! $\gamma_m$" ea_gamma_m
    "Share of capital services in stage T-2 production !! $\gamma_\mathit{uk}$" ea_gamma_uk
    "Share of commodity inputs in stage T-1 production !! $\gamma_q$" ea_gamma_q
    "Share of roundabout intermediates in stage T-0 production !! $\gamma_\mathit{yz}$" ea_gamma_yz

    "Monopoly power (markup) of local producers !! $\mu_\mathit{py}$" ea_mu_py
    "Markup to cover overhead labor !! $\mu_{y3}$" ea_mu_y3


!parameters(:production :dynamic)

    "Autoregression in area specific productivity component !! $\rho_\mathit{ar}$" ea_rho_ar
    "Weight on S/S inflation in inflation indexation !! $\zeta_\mathit{py}$" ea_zeta_py
    "Stage T-2 input factor adjustment cost parameter !! $\xi_{y2}$" ea_xi_y2
    "Stage T-1 input factor adjustment cost parameter !! $\xi_{y1}$" ea_xi_y1
    "Price adjustment cost parameters !! $\xi_\mathit{py}$" ea_xi_py


!shocks(:production)

    "Shock to area specific productivity component" ea_shk_ar
    "Shock to final price setting" ea_shk_py


!equations(:production)


    "Area-specific relative productivity component"
    log(ea_ar) = + ea_rho_ar * log(ea_ar{-1}) + (1 - ea_rho_ar) * log(ea_ss_ar) + ea_shk_ar !! ea_ar = ea_ss_ar;


    "Definition of variable labor input"
    ea_nv = (ea_nh - ea_gamma_n0*&ea_nh) * ea_nf;

    "Stage T-3 production function"
    ea_y3 = (ea_my/ea_gamma_m)^ea_gamma_m * ([ea_ar * gg_a * ea_nv]/(1-ea_gamma_m))^(1-ea_gamma_m);

    "Demand for intermediate imports"
    ea_gamma_m * ea_py3 * ea_y3 = (ea_pmm * gg_dmm) * ea_my * [1 + ea_xi_y3*((log(ea_my/ea_y3)-log(ea_my{-1}/ea_y3{-1}))-&ea_rdf*(log(ea_my{+1}/ea_y3{+1})-log(ea_my/ea_y3)))] !! ea_gamma_m * ea_py3 * ea_y3 = (ea_pmm * gg_dmm) * ea_my;

    "Demand for labor"
    (1-ea_gamma_m) * ea_py3 * ea_y3 = ea_mu_y3 * ea_w * ea_nv * [1 + ea_xi_y3*((log(ea_nv/ea_y3)-log(ea_nv{-1}/ea_y3{-1})-log(&ea_roc_nv/&ea_roc_y3))-&ea_rdf*(log(ea_nv{+1}/ea_y3{+1})-log(ea_nv/ea_y3)-log(&ea_roc_nv/&ea_roc_y3)))] !! (1-ea_gamma_m) * ea_py3 * ea_y3 = ea_mu_y3 * ea_w * ea_nv;


    ea_y2 = (ea_uk/ea_gamma_uk)^ea_gamma_uk * (ea_y3/(1-ea_gamma_uk))^(1-ea_gamma_uk);

    ea_gamma_uk * ea_py2 * ea_y2 = ea_pu * ea_uk * [1 + ea_xi_y2*((log(ea_uk/ea_y2)-log(ea_uk{-1}/ea_y2{-1}))-&ea_rdf*(log(ea_uk{+1}/ea_y2{+1})-log(ea_uk/ea_y2)))] !! ea_gamma_uk * ea_py2 * ea_y2 = ea_pu * ea_uk;

    (1-ea_gamma_uk) * ea_py2 * ea_y2 = ea_py3 * ea_y3 * [1 + ea_xi_y2*((log(ea_y3/ea_y2)-log(ea_y3{-1}/ea_y2{-1}))-&ea_rdf*(log(ea_y3{+1}/ea_y2{+1})-log(ea_y3/ea_y2)))] !! (1-ea_gamma_uk) * ea_py2 * ea_y2 = ea_py3 * ea_y3;


    ea_py1 = ea_py2^(1 - ea_gamma_q) * ea_pq^ea_gamma_q !! ea_y1 = (ea_y2/(1-ea_gamma_q))^(1-ea_gamma_q) * (ea_mq/ea_gamma_q)^ea_gamma_q;

        (1-ea_gamma_q) * &ea_py1 * ea_y1 = &ea_py2 * ea_y2 !! (1-ea_gamma_q) * ea_py1 * ea_y1 = ea_py2 * ea_y2 ;

        (ea_gamma_q) * &ea_py1 * ea_y1 = &ea_pq * ea_mq !! ea_gamma_q * ea_py1 * ea_y1 = ea_pq * ea_mq ;


    ea_y = ea_y1;
    ea_py0 = ea_py1;
    ea_yz = 1;


    ea_mu_py*ea_py0*exp(ea_shk_py) = ea_py*[1 + (ea_mu_py-1)*ea_xi_py*(log(ea_roc_py/ea_ref_roc_py) - ea_beta*gg_zy*ea_zy*log(ea_roc_py{+1}/ea_ref_roc_py{+1}))] !! ea_py = ea_mu_py * ea_py0;

    ea_ref_roc_py = ea_roc_py{-1}^(1-ea_zeta_py) * &ea_roc_py^ea_zeta_py;

    ea_pc = ea_py;
    ea_pih = ea_py;


    ea_y = ea_ch + ea_cg + ea_ih + ea_yxx;


        ea_roc_cg = ea_cg / ea_cg{-1};
    
        ea_roc_pc = ea_pc / ea_pc{-1};
    
        ea_roc_py = ea_py / ea_py{-1};
    
        ea_roc_y3 = ea_y3 / ea_y3{-1};
    
        ea_roc_nv = ea_nv / ea_nv{-1};


    "Per-capita private consumption"
    ea_ch_to_nn = ea_ch / ea_nn;

    "Nominal GDP"
    ea_ngdp = ea_pc*ea_ch + ea_pih*ea_ih + ea_pc*ea_cg + ea_pxx*ea_xx - ea_pmm*ea_mm + ea_pq*(ea_xq - ea_mq);

    "Real GDP index, Y/Y"
    ea_roc_gdp = + (ea_pc*ea_ch/ea_ngdp + ea_pc{-1}*ea_ch{-1}/ea_ngdp{-1})/2 * ((ea_ch)/(ea_ch{-1})) + (ea_pih*ea_ih/ea_ngdp + ea_pih{-1}*ea_ih{-1}/ea_ngdp{-1})/2 * ((ea_ih)/(ea_ih{-1})) + (ea_pc*ea_cg/ea_ngdp + ea_pc{-1}*ea_cg{-1}/ea_ngdp{-1})/2 * ((ea_cg)/(ea_cg{-1})) + (ea_pxx*ea_xx/ea_ngdp + ea_pxx{-1}*ea_xx{-1}/ea_ngdp{-1})/2 * ((ea_xx)/(ea_xx{-1})) - (ea_pmm*ea_mm/ea_ngdp + ea_pmm{-1}*ea_mm{-1}/ea_ngdp{-1})/2 * ((ea_mm)/(ea_mm{-1})) + (ea_pq*ea_xq/ea_ngdp + ea_pq{-1}*ea_xq{-1}/ea_ngdp{-1})/2 * ((ea_xq)/(ea_xq{-1})) - (ea_pq*ea_mq/ea_ngdp + ea_pq{-1}*ea_mq{-1}/ea_ngdp{-1})/2 * ((ea_mq)/(ea_mq{-1})) !! ea_roc_gdp = gg_ss_roc_a * gg_ss_roc_nt;

    "Per-capita real GDP index, Y/Y"
    ea_roc_gdp_to_nn = ea_roc_gdp / ea_roc_nn;


!postprocessor(:production)

    ea_nch_to_ngdp = ea_pc * ea_ch / ea_ngdp;
    ea_nih_to_ngdp = ea_pih * ea_ih / ea_ngdp;
    ea_nkh_to_ngdp = ea_pk * ea_k / ea_ngdp;
    ea_curr_to_ngdp = ((ea_w*ea_nh*ea_nf - ea_txls2_to_nc*ea_pc*ea_ch)) / ea_ngdp;
    ea_gdp = ea_gdp{-1} * ea_roc_gdp;


!log-variables !all-but

    ea_nch_to_ngdp
    ea_nih_to_ngdp
    ea_nkh_to_ngdp
    ea_curr_to_ngdp


!variables(:monetary)

    "Nominal short-term rate, LCY" ea_r
    "Monetary policy reaction term" ea_react
    "Unconstrained nominal short-term rate, LCY" ea_unc_r
    "Nominal short-term rate for interest parity, LCY" ea_rip 


!parameters(:monetary :steady)

    "S/S Price of private consumption, Y/Y !! $\roc{\mathit{pc}}_\ss$" ea_ss_roc_pc
    "Switch for lower bound on short-term rate !! $\mathit{floor}$" ea_floor


!parameters(:monetary :dynamic)

    "A/R in policy rate !! $\rho_r$" ea_rho_r 
    "Monetary policy reaction to CPI !! $\psi_\mathit{pc}$" ea_psi_pc 
    "Monetary policy reaction to nominal exchange rate !! $\psi_e$" ea_psi_e
    "Monetary policy reaction to real economic activity !! $\psi_\mathit{nh}$" ea_psi_nh
    "Pressure relief valve for interest rate lower bound !! $\theta_\mathir{rip}$" ea_theta_rip


!shocks(:monetary)

    "Shock to monetary policy reaction function" ea_shk_r


!log-variables !all-but

    ea_react


!equations(:monetary)

    "Monetary policy reaction function"
    log(ea_unc_r) = + ea_rho_r * log(ea_r{-1}) + (1 - ea_rho_r) * [ log(&ea_unc_r) + ea_react ] + ea_shk_r !! ea_pc = ea_pc{-1} * ea_ss_roc_pc;


    "Monetary policy reaction term"
    ea_react = + ea_psi_pc * (log(ea_roc_pc{+1}) - log(ea_ss_roc_pc)) + ea_psi_e * (log(ea_roc_e) - log(&ea_roc_e)) + ea_psi_nh * (log(ea_nh{+1}) - log(&ea_nh)) !! ea_react = 0;


    "Zero floor constraint on policy rate"
    ea_r = ea_floor*max(1, ea_unc_r) + (1-ea_floor)*ea_unc_r !! ea_r = ea_unc_r;

    ea_rip = ea_r + ea_theta_rip*(ea_unc_r - ea_r) !! ea_rip = ea_r;


!variables

    "Government debt interest rate" ea_rg
    "Government consumption" ea_cg
    "Government debt to GDP ratio" ea_dg_to_ngdp
    "Net lump-sum tax 1 to consumption ratio" ea_txls1_to_nc
    "Net lump-sum tax 2 to consumption ratio" ea_txls2_to_nc
    "Government consumption, Y/Y" ea_roc_cg
    "Import tariff rate" ea_trm


!log-variables !all-but

    ea_txls1_to_nc, ea_txls2_to_nc, ea_dg_to_ngdp, ea_trm


!parameters(:fiscal :steady)

    "S/S Government debt to GDP ratio !! $\tratio{\mathit{dg}}{\mathit{ngdp}}_\ss$" ea_ss_dg_to_ngdp
    "S/S Government consumption to GDP ratio !! $\tratio{\mathit{ncg}}{\mathit{ngdp}}_\ss$" ea_ss_ncg_to_ngdp
    "S/S General import tariff rate !! $\mathit{trm}_\ss$" ea_ss_trm


!parameters(:fiscal :dynamic)

    "Response in government consumption to government debt !! $\tau_\mathit{cg}$" ea_tau_cg
    "Response in type 1 lump-sum tax rate to government debt !! $\tau_{\mathit{txls},1}$" ea_tau_txls1
    "Autoregression in government consumption !! $\rho_\mathit{cg}$" ea_rho_cg
    "Autoregression in type 1 lump-sum tax rate !! $\rho_{\mathit{txls},1}$" ea_rho_txls1
    "Autoregression in type 2 lump-sum tax rate !! $\rho_{\mathit{txls},2}$" ea_rho_txls2
    "Autoregression in generate import tariff rate !! $\rho_\mathit{trm}$" ea_rho_trm


!shocks

    "Shock to government consumption" ea_shk_cg
    "Shock to type 1 lump-sum taxes" ea_shk_txls1
    "Shock to type 2 lump-sum taxes" ea_shk_txls2
    "Shock to general import tariff rate" ea_shk_trm


!equations

    ea_rg = ea_r;

    
    "Dynamic fiscal budget constraint"
    ea_dg_to_ngdp*ea_ngdp = + ea_rg{-1}*ea_dg_to_ngdp{-1}*ea_ngdp{-1} + ea_pc*ea_cg - (ea_txls1_to_nc + ea_txls2_to_nc) * ea_pc*ea_ch - (ea_pmm - ea_fob_pmm) * ea_mm;


    "Fiscal reaction function for government consumption"
    log(ea_cg) = + ea_rho_cg * log(ea_cg{-1}*&ea_roc_cg) + (1 - ea_rho_cg) * log(ea_ss_ncg_to_ngdp*ea_ngdp/ea_pc) - ea_tau_cg * (ea_dg_to_ngdp{+1} - ea_ss_dg_to_ngdp) + ea_shk_cg !! ea_pc*ea_cg = ea_ss_ncg_to_ngdp*ea_ngdp;


    "Fiscal reaction function for type 1 net lump-sum taxes"
    ea_txls1_to_nc = + ea_rho_txls1 * ea_txls1_to_nc{-1} + (1-ea_rho_txls1) * &ea_txls1_to_nc + ea_tau_txls1 * (ea_dg_to_ngdp{+1} - ea_ss_dg_to_ngdp) + ea_shk_txls1 !! ea_dg_to_ngdp = ea_ss_dg_to_ngdp;


    "Fiscal reaction function for type 2 net lump-sum taxes"
    ea_txls2_to_nc = + ea_rho_txls2*ea_txls2_to_nc{-1} + ea_shk_txls2 !! ea_txls2_to_nc = 0;


    "Fiscal reaction function for import tariffs rate"
    ea_trm = + ea_rho_trm * ea_trm{-1} + (1 - ea_rho_trm) * ea_ss_trm + ea_shk_trm !! ea_trm = ea_ss_trm;


!variables(:open)

    "Non-commodity imports" ea_mm
    "Price of non-commodity imports" ea_pmm
    "Price of non-commodity imports, FOB" ea_fob_pmm
    "Imports for non-commodity exports" ea_mxx
    "Imports for domestic production" ea_my

    "Domestic content of non-commodity exports" ea_yxx
    "Non-commodity exports" ea_xx
    "Commodity exports" ea_xq
    "Price of non-commodity exports" ea_pxx

    "Net foreign fixed-income assets to GDP Ratio" ea_nfa_to_ngdp
    "Primary income rate on net foreign fixed-income assets" ea_rnfa
    "Checksum for net foreign fixed-income assets to GDP ratio" ea_nfa_to_ngdp_checksum
    "Nominal exchange rate" ea_e
    "Expectations of nominal exchange rate" ea_exp_e
    "Nominal Exchange Rate, Y/Y" ea_roc_e
    "BOP CA corporate equity primary income to GDP ratio" ea_bpceq_to_ngdp
    "BOP FA corporate equity transactions to GDP ratio" ea_bpfeq_to_ngdp
    "Price of non-commodity exports, Reference ccy" ea_pxx_rcy
    "Value of non-commodity exports, Reference ccy" ea_nxx_rcy
    "Net claims of financial sector on households" ea_bh_to_ngdp
    "Non-commodity imports to GDP ratio" ea_nmm_to_ngdp
    "Non-commodity exports to GDP ratio" ea_nxx_to_ngdp
    "Net commodity exports to GDP ratio" ea_netxq_to_ngdp
    "Net non-commodity exports to GDP ratio" ea_netxx_to_ngdp

    "Country credit risk" ea_zh
    "Autonomous component in country credit risk" ea_zh_aut


!log-variables !all-but

    ea_nfa_to_ngdp
    ea_nfa_to_ngdp_checksum
    ea_bpfeq_to_ngdp
    ea_bpceq_to_ngdp
    ea_bh_to_ngdp
    ea_nmm_to_ngdp
    ea_nxx_to_ngdp
    ea_netxq_to_ngdp
    ea_netxx_to_ngdp
    ea_zh_aut


!parameters(:open :steady)

    "Import intensity of non-commodity exports !! $\alpha$" ea_alpha
    "Acceleration in exportable productivity !! $\gamma_\mathit{xx}$" ea_gamma_xx
    "Elasticity of household risk function wrt NFA !! $\theta_1$" ea_theta_1
    "Curvature of household risk function wrt NFA !! $\theta_2$" ea_theta_2
    "Share of local commodity production in world commodity production !! $\lambda$" ea_lambda
    "S/S Autonomous component in country credit risk !! $\mathit{zh}^\mathrm{aut}_\ss$" ea_ss_zh_aut


!parameters(:open :dynamic)

    "A/R Autonomous component in country credit risk !! $\rho_{\mathit{zh}}^\mathrm{aut}$" ea_rho_zh_aut
    "Weight on model-consistent expectations in exchange rate !! $\zeta_e$" ea_zeta_e
    "Adjustment cost parameter in stage t-3 production !! $\xi_{y3}$" ea_xi_y3


!shocks(:open)

    "Interest parity shock" ea_shk_e
    "Shock to country credit risk" ea_shk_zh
    "Shock to autonoumous component in country credit risk" ea_shk_zh_aut


!equations(:open)


    "Distribution of non-commodity imports"
    ea_mm = ea_my + ea_mxx;


    "Commodity endowment"
    ea_xq = ea_lambda * gg_q;

    "Commodity prices in local currency"
    ea_pq = gg_pq * ea_e;


    "Non-commodity export production function"
    ea_xx = ea_ar^ea_gamma_xx * (ea_yxx/(1-ea_alpha))^(1-ea_alpha) * (ea_mxx/ea_alpha)^ea_alpha;

    "Demand for local content in export production"
    (1-ea_alpha) * ea_pxx * ea_xx = ea_py * ea_yxx;

    "Demand for re-exports"
    ea_alpha * ea_pxx * ea_xx = (ea_pmm * gg_dmm) * ea_mxx;


    "Balance of payments transactions"
    ea_nfa_to_ngdp * ea_ngdp - ea_nfa_to_ngdp{-1} * ea_ngdp{-1} = + ea_bpfeq_to_ngdp * ea_ngdp + (ea_rnfa - 1) * ea_nfa_to_ngdp{-1} * ea_ngdp{-1} + ea_bpceq_to_ngdp*ea_ngdp + ea_pxx * ea_xx - ea_fob_pmm * ea_mm + ea_netxq_to_ngdp * ea_ngdp + ea_nfa_to_ngdp_checksum * ea_ngdp;

    "Local interest spread"
    ea_zh = + ea_zh_aut + ea_theta_1 * (1/ea_theta_2)*[ exp(-ea_theta_2*ea_nfa_to_ngdp*ea_ngdp/(ea_pk*ea_k)) - 1 ] + ea_shk_zh;

    "Autonomous component in local interest spread"
    ea_zh_aut = + ea_rho_zh_aut * ea_zh_aut{-1} + (1 - ea_rho_zh_aut) * ea_ss_zh_aut + ea_shk_zh_aut !! ea_zh_aut = ea_ss_zh_aut;


    "Net balance sheet of local financial sector"
    ea_bh_to_ngdp + ea_dg_to_ngdp + ea_nfa_to_ngdp = 0;


    "Nominal Exchange Rate Expectations"
    ea_exp_e = ea_e{+1}^ea_zeta_e * (ea_e*&ea_roc_e)^(1-ea_zeta_e);


    ea_roc_e = ea_e / ea_e{-1};


    "Price of non-commodity exports in reference currency"
    ea_pxx_rcy = ea_pxx / ea_e;

    "Value of non-commodity exports in reference currency"
    ea_nxx_rcy = ea_pxx_rcy * ea_xx;


    "Total imports to GDP ratio"
    ea_nmm_to_ngdp = ea_fob_pmm*ea_mm / ea_ngdp;
    ea_nxx_to_ngdp = ea_pxx*ea_xx / ea_ngdp;
    ea_netxq_to_ngdp = ea_pq*(ea_xq - ea_mq) / ea_ngdp;
    ea_netxx_to_ngdp = ea_nxx_to_ngdp - ea_nmm_to_ngdp;


!postprocessor

    ea_nmxx_to_ngdp = ea_fob_pmm * ea_mxx / ea_ngdp;


!log-variables !all-but

    ea_nmm_to_ngdp
    ea_nxx_to_ngdp
    ea_nmxx_to_ngdp


!variables

    "Total population" cn_nn
    "Total population, Y/Y" cn_roc_nn
    "Area specific component in total population" cn_nr
    "Working age population" cn_nw
    "Labor force" cn_nf


!log-variables !all-but


!parameters(:demography :steady)

    "S/S Population, Relative to global population component !! $\mathit{nr}_\ss$" cn_ss_nr
    "S/S Share of working age population in total population !! $\tratio{\mathit{nw}}{\mathit{nn}}_\ss$" cn_ss_nw_to_nn
    "S/S Labor participation rate !! $\tratio{\mathit{nf}}{\mathit{nw}}_\ss$" cn_ss_nf_to_nw


!parameters(:demography :dynamic)

    "A/R Total population relative to global population component !! $\rho_\mathit{nr}$" cn_rho_nr
    "A/R Share of working age population in total population !! $\rho_\mathit{nw}$" cn_rho_nw
    "A/R Labor participation rate !! $\rho_\mathit{nf}$" cn_rho_nf


!shocks

    "Shock to relative population component" cn_shk_nr
    "Shock to share of working age population" cn_shk_nw_to_nn
    "Shock to labor participation rate" cn_shk_nf_to_nw


!equations

    "Total population relative to global population component"
    log(cn_nr) = cn_rho_nr * log(cn_nr{-1}) + (1-cn_rho_nr) * log(cn_ss_nr) + cn_shk_nr !! cn_nr = cn_ss_nr;


    "Total population"
    cn_nn = cn_nr * gg_nt;


    "Total population, Y/Y"
    cn_roc_nn = cn_nn / cn_nn{-1} !! cn_roc_nn = gg_ss_roc_nt;


    "Share of working age population"
    cn_nw/cn_nn = + cn_rho_nw * cn_nw{-1}/cn_nn{-1} + (1-cn_rho_nw) * cn_ss_nw_to_nn + cn_shk_nw_to_nn !! cn_nw = cn_ss_nw_to_nn * cn_nn;


    "Labor participation rate"
    cn_nf/cn_nw = + cn_rho_nf * cn_nf{-1}/cn_nw{-1} + (1-cn_rho_nf) * cn_ss_nf_to_nw + cn_shk_nf_to_nw !! cn_nf = cn_ss_nf_to_nw * cn_nw;


!variables(:households)

    "Private consumption" cn_ch
    "Per-capita private consumption" cn_ch_to_nn
    "Private consumption reference level" cn_ref_ch_to_ch
    "Real discount factor" cn_rdf
    "Per-worker labor supply" cn_nh
    "Private investment" cn_ih
    "Uncertainty in capital" cn_zk
    "Uncertainty in profits" cn_zy
    "Ex-post return on capital" cn_rk
    "Production capital" cn_k
    "Production capital services" cn_uk
    "Portfolio of claims on production capital" cn_kk
    "Household net worth" cn_netw
    "Nominal wage rate" cn_w
    "Real labor income" cn_rli

    "Price of production capital" cn_pk
    "Price of production capital services" cn_pu
    "Real consumer wage rate" cn_w_to_pc
    "Flexible nominal wage rate" cn_ww

    "Nominal wage rate, Y/Y" cn_roc_w
    "Household investment, Y/Y" cn_roc_ih
    "Production capital, Y/Y" cn_roc_k


!log-variables !all-but

    cn_ref_ch_to_ch


!parameters(:households :steady)

    "S/S Uncertainty discount factor on capital !! $\mathit{zk}_\mathrm{ss}$" cn_ss_zk
    "S/S Uncertainty discount factor on production cash flows !! $\mathit{zy}_\mathrm{ss}$" cn_ss_zy
    "Household discount factor !! $\beta$" cn_beta
    "Depreciation of production capital !! $\delta$" cn_delta
    "Inverse elasticity of labor supply !! $\eta$" cn_eta
    "Utility location parameter of labor supply !! $\eta_0$" cn_eta0
    "Intercept in current wealth utility !! $\nu_0$" cn_nu_0
    "Slope of current wealth utility !! $\nu_1$" cn_nu_1
    "Level parameter in cost of utilization of production capital !! $\upsilon_0$" cn_upsilon_0
    "Inverse elasticity of cost of utilization of production capital !! $\upsilon_1$" cn_upsilon_1


!parameters(:households :dynamic)

    "A/R in real wage rate !! $\rho_w$" cn_rho_w
    "A/R in uncertainty discount factor on capital !! $\rho_\mathit{zk}$" cn_rho_zk
    "A/R in uncertainty discount factor on production cash flows !! $\rho_\mathit{zy}$" cn_rho_zy
    "Point of reference in consuptions switch !! $\chi$" cn_chi
    "Past consumption in reference consumption parameter !! $\chi_\mathit{ch}$" cn_chi_ch
    "Current income in reference consumption parameter !! $\chi_\mathit{curr}$" cn_chi_curr
    "Type 1 investment adjustment cost parameter !! $\xi_\mathit{ih,1}$" cn_xi_ih1
    "Type 2 investment adjustment cost parameter !! $\xi_\mathit{ih,2}$" cn_xi_ih2
    "Pressure relief valve for interest rate lower bound !! $\theta_\mathir{rh}$" cn_theta_rh


!shocks(:households)

    "Shock to intertemporal preferences" cn_shk_beta
    "Shock to private consumption" cn_shk_ch
    "Shock to private investment" cn_shk_ih
    "Shock to wage rate" cn_shk_w
    "Shock to current income" cn_shk_curr
    "Shock to uncertainty discount factor on capital" cn_shk_zk
    "Shock to uncertainty discount factor on production cash flows" cn_shk_zy


!equations(:households)


    "Optimal choice of household consumption"
    cn_vh*cn_pc*(cn_ch - cn_chi*cn_ref_ch_to_ch*cn_ch)*exp(-cn_shk_ch) = cn_nn*(1 - cn_chi*&cn_ref_ch_to_ch) !! cn_vh*cn_pc*cn_ch = cn_nn;

    "Point of reference in household consumption" 
    cn_ref_ch_to_ch = [ cn_chi_curr*((cn_w*cn_nh*cn_nf - cn_txls2_to_nc*cn_pc*cn_ch))/cn_pc + cn_chi_ch*cn_ch{-1}*gg_ss_roc_a ] / cn_ch;

    "Optimal choice of net position with local financial sector"
    cn_vh = cn_beta*cn_vh{+1}*cn_rh + cn_nn/(cn_pc*cn_ch)*[ cn_nu_1*(cn_pc*cn_ch/cn_netw - cn_nu_0) - gg_nu ] * exp(cn_shk_beta) !! 1 = cn_beta*cn_rh/gg_ss_roc_a/cn_ss_roc_pc + cn_nu_1*cn_nch_to_netw_minus_nu_0 - gg_nu;

    "Auxiliary equation for steady-state calibration of nu_0"
    cn_nch_to_netw_minus_nu_0 = cn_pc * cn_ch / cn_netw - cn_nu_0;

    cn_rdf = cn_beta*cn_vh{+1}*cn_pc{+1}/(cn_vh*cn_pc);

    "Risk adjusted household rate"
    cn_rh = cn_r + cn_theta_rh*(cn_unc_r - cn_r) + cn_zh;

    "Current net worth of households"
    cn_netw = cn_kk + cn_dg_to_ngdp*cn_ngdp + cn_nfa_to_ngdp*cn_ngdp;

    "Uncertainty discount factor on capital"
    log(cn_zk) = cn_rho_zk*log(cn_zk{-1}) + (1-cn_rho_zk)*log(cn_ss_zk) + cn_shk_zk !! cn_zk = cn_ss_zk;

    "Uncertainty discount factor on production cash flows"
    log(cn_zy) = cn_rho_zy*log(cn_zy{-1}) + (1-cn_rho_zy)*log(cn_ss_zy) + cn_shk_zy !! cn_zy = cn_ss_zy;

    "Real labor income"
    cn_rli = cn_w*cn_nh*cn_nf / cn_pc; 


    "Optimal choice of per-worker hours worked"
    cn_vh * cn_ww = cn_eta0 * cn_nh^cn_eta;

    "Real consumer wage rate"
    cn_w_to_pc = cn_w / cn_pc;

    "Real wage rigidities"
    log(cn_w_to_pc) = + cn_rho_w * [log(cn_w_to_pc{-1}) + log(&cn_roc_w/&cn_roc_pc)] + (1-cn_rho_w) * log(cn_ww/cn_pc) + cn_shk_w !! cn_w = cn_ww;


    "Optimal choice of investment in local production capital"
    cn_pk * exp(cn_shk_ih) = cn_pih*[ 1 + cn_xi_ih1*(log(cn_ih) - log((&cn_ih/&cn_k*&cn_roc_k)*cn_k{-1})) + cn_xi_ih2*(log(cn_ih/cn_ih{-1}/&cn_roc_ih) - cn_beta*log(cn_ih{+1}/cn_ih/&cn_roc_ih)) ] !! cn_pk = cn_pih;

    "Accumulation of production capital"
    cn_k = (1-cn_delta)*cn_k{-1} + cn_ih;

    "Definition of utilized production capital"
    cn_uk = cn_u * cn_k;

    "Optimal choice of utilization rate of production capital"
    cn_py * cn_upsilon_0 * cn_u^cn_upsilon_1 = cn_pu;

    "Auxiliary equation for steady-state calibration of upsilon_0"
    cn_upsilon_1_py_to_pu = cn_upsilon_0 * cn_py / cn_pu;

    "Ex-post return on capital"
    cn_rk*cn_pk{-1} = cn_u{-1}*cn_pu{-1}*cn_rh{-1} + (1-cn_delta)*cn_pk;


        cn_roc_w = cn_w / cn_w{-1};
    
        cn_roc_ih = cn_ih / cn_ih{-1};
    
        cn_roc_k = cn_k / cn_k{-1};


!variables(:production)

    "Area specific productivity component" cn_ar
    "Shadow value of household budget constraing" cn_vh
    "Price of private consumption" cn_pc
    "Price of private investment" cn_pih
    "Domestic intermediate inputs" cn_yz
    "Stage T-3 output" cn_y3
    "Stage T-2 output" cn_y2
    "Stage T-1 output" cn_y1
    "Stage T-0 output" cn_y
    "Price of stage T-3 output" cn_py3
    "Price of state T-2 output" cn_py2
    "Price of state T-1 output" cn_py1
    "Price of stage T-0 output" cn_py0
    "Price of commodity input into production" cn_pq

    "Commodity input into production" cn_mq
    "Variable labor input into production" cn_nv

    "Nominal GDP" cn_ngdp
    "Real GDP index, Y/Y" cn_roc_gdp
    "Per-capita real GDP index, Y/Y" cn_roc_gdp_to_nn

    "Price of domestic production" cn_py
    "Nominal household rate, LCY" cn_rh

    "Price of final domestic output, Y/Y" cn_roc_py
    "Price of final domestic output, Y/Y, Point of reference" cn_ref_roc_py
    "Price of consumer goods, Y/Y" cn_roc_pc
    "Utilization rate of production capital" cn_u
    "Stage T-3 output, Y/Y" cn_roc_y3
    "Variable labor, Y/Y" cn_roc_nv

    "Auxiliary variable for steady-state calibration of upsilon_0" cn_upsilon_1_py_to_pu
    "Auxiliary equation for steady-state calibration of nu_0" cn_nch_to_netw_minus_nu_0


!log-variables !all-but

    cn_zh, cn_nch_to_netw_minus_nu_0


!parameters(:production :steady)

    "S/S Area specific productivity component !! $\mathit{ar}_\ss$" cn_ss_ar

    "Share of overhead labor !! $\gamma_\mathit{n0}$" cn_gamma_n0
    "Share of intermediate imports in stage T-3 production !! $\gamma_m$" cn_gamma_m
    "Share of capital services in stage T-2 production !! $\gamma_\mathit{uk}$" cn_gamma_uk
    "Share of commodity inputs in stage T-1 production !! $\gamma_q$" cn_gamma_q
    "Share of roundabout intermediates in stage T-0 production !! $\gamma_\mathit{yz}$" cn_gamma_yz

    "Monopoly power (markup) of local producers !! $\mu_\mathit{py}$" cn_mu_py
    "Markup to cover overhead labor !! $\mu_{y3}$" cn_mu_y3


!parameters(:production :dynamic)

    "Autoregression in area specific productivity component !! $\rho_\mathit{ar}$" cn_rho_ar
    "Weight on S/S inflation in inflation indexation !! $\zeta_\mathit{py}$" cn_zeta_py
    "Stage T-2 input factor adjustment cost parameter !! $\xi_{y2}$" cn_xi_y2
    "Stage T-1 input factor adjustment cost parameter !! $\xi_{y1}$" cn_xi_y1
    "Price adjustment cost parameters !! $\xi_\mathit{py}$" cn_xi_py


!shocks(:production)

    "Shock to area specific productivity component" cn_shk_ar
    "Shock to final price setting" cn_shk_py


!equations(:production)


    "Area-specific relative productivity component"
    log(cn_ar) = + cn_rho_ar * log(cn_ar{-1}) + (1 - cn_rho_ar) * log(cn_ss_ar) + cn_shk_ar !! cn_ar = cn_ss_ar;


    "Definition of variable labor input"
    cn_nv = (cn_nh - cn_gamma_n0*&cn_nh) * cn_nf;

    "Stage T-3 production function"
    cn_y3 = (cn_my/cn_gamma_m)^cn_gamma_m * ([cn_ar * gg_a * cn_nv]/(1-cn_gamma_m))^(1-cn_gamma_m);

    "Demand for intermediate imports"
    cn_gamma_m * cn_py3 * cn_y3 = (cn_pmm * gg_dmm) * cn_my * [1 + cn_xi_y3*((log(cn_my/cn_y3)-log(cn_my{-1}/cn_y3{-1}))-&cn_rdf*(log(cn_my{+1}/cn_y3{+1})-log(cn_my/cn_y3)))] !! cn_gamma_m * cn_py3 * cn_y3 = (cn_pmm * gg_dmm) * cn_my;

    "Demand for labor"
    (1-cn_gamma_m) * cn_py3 * cn_y3 = cn_mu_y3 * cn_w * cn_nv * [1 + cn_xi_y3*((log(cn_nv/cn_y3)-log(cn_nv{-1}/cn_y3{-1})-log(&cn_roc_nv/&cn_roc_y3))-&cn_rdf*(log(cn_nv{+1}/cn_y3{+1})-log(cn_nv/cn_y3)-log(&cn_roc_nv/&cn_roc_y3)))] !! (1-cn_gamma_m) * cn_py3 * cn_y3 = cn_mu_y3 * cn_w * cn_nv;


    cn_y2 = (cn_uk/cn_gamma_uk)^cn_gamma_uk * (cn_y3/(1-cn_gamma_uk))^(1-cn_gamma_uk);

    cn_gamma_uk * cn_py2 * cn_y2 = cn_pu * cn_uk * [1 + cn_xi_y2*((log(cn_uk/cn_y2)-log(cn_uk{-1}/cn_y2{-1}))-&cn_rdf*(log(cn_uk{+1}/cn_y2{+1})-log(cn_uk/cn_y2)))] !! cn_gamma_uk * cn_py2 * cn_y2 = cn_pu * cn_uk;

    (1-cn_gamma_uk) * cn_py2 * cn_y2 = cn_py3 * cn_y3 * [1 + cn_xi_y2*((log(cn_y3/cn_y2)-log(cn_y3{-1}/cn_y2{-1}))-&cn_rdf*(log(cn_y3{+1}/cn_y2{+1})-log(cn_y3/cn_y2)))] !! (1-cn_gamma_uk) * cn_py2 * cn_y2 = cn_py3 * cn_y3;


    cn_py1 = cn_py2^(1 - cn_gamma_q) * cn_pq^cn_gamma_q !! cn_y1 = (cn_y2/(1-cn_gamma_q))^(1-cn_gamma_q) * (cn_mq/cn_gamma_q)^cn_gamma_q;

        (1-cn_gamma_q) * &cn_py1 * cn_y1 = &cn_py2 * cn_y2 !! (1-cn_gamma_q) * cn_py1 * cn_y1 = cn_py2 * cn_y2 ;

        (cn_gamma_q) * &cn_py1 * cn_y1 = &cn_pq * cn_mq !! cn_gamma_q * cn_py1 * cn_y1 = cn_pq * cn_mq ;


    cn_y = cn_y1;
    cn_py0 = cn_py1;
    cn_yz = 1;


    cn_mu_py*cn_py0*exp(cn_shk_py) = cn_py*[1 + (cn_mu_py-1)*cn_xi_py*(log(cn_roc_py/cn_ref_roc_py) - cn_beta*gg_zy*cn_zy*log(cn_roc_py{+1}/cn_ref_roc_py{+1}))] !! cn_py = cn_mu_py * cn_py0;

    cn_ref_roc_py = cn_roc_py{-1}^(1-cn_zeta_py) * &cn_roc_py^cn_zeta_py;

    cn_pc = cn_py;
    cn_pih = cn_py;


    cn_y = cn_ch + cn_cg + cn_ih + cn_yxx;


        cn_roc_cg = cn_cg / cn_cg{-1};
    
        cn_roc_pc = cn_pc / cn_pc{-1};
    
        cn_roc_py = cn_py / cn_py{-1};
    
        cn_roc_y3 = cn_y3 / cn_y3{-1};
    
        cn_roc_nv = cn_nv / cn_nv{-1};


    "Per-capita private consumption"
    cn_ch_to_nn = cn_ch / cn_nn;

    "Nominal GDP"
    cn_ngdp = cn_pc*cn_ch + cn_pih*cn_ih + cn_pc*cn_cg + cn_pxx*cn_xx - cn_pmm*cn_mm + cn_pq*(cn_xq - cn_mq);

    "Real GDP index, Y/Y"
    cn_roc_gdp = + (cn_pc*cn_ch/cn_ngdp + cn_pc{-1}*cn_ch{-1}/cn_ngdp{-1})/2 * ((cn_ch)/(cn_ch{-1})) + (cn_pih*cn_ih/cn_ngdp + cn_pih{-1}*cn_ih{-1}/cn_ngdp{-1})/2 * ((cn_ih)/(cn_ih{-1})) + (cn_pc*cn_cg/cn_ngdp + cn_pc{-1}*cn_cg{-1}/cn_ngdp{-1})/2 * ((cn_cg)/(cn_cg{-1})) + (cn_pxx*cn_xx/cn_ngdp + cn_pxx{-1}*cn_xx{-1}/cn_ngdp{-1})/2 * ((cn_xx)/(cn_xx{-1})) - (cn_pmm*cn_mm/cn_ngdp + cn_pmm{-1}*cn_mm{-1}/cn_ngdp{-1})/2 * ((cn_mm)/(cn_mm{-1})) + (cn_pq*cn_xq/cn_ngdp + cn_pq{-1}*cn_xq{-1}/cn_ngdp{-1})/2 * ((cn_xq)/(cn_xq{-1})) - (cn_pq*cn_mq/cn_ngdp + cn_pq{-1}*cn_mq{-1}/cn_ngdp{-1})/2 * ((cn_mq)/(cn_mq{-1})) !! cn_roc_gdp = gg_ss_roc_a * gg_ss_roc_nt;

    "Per-capita real GDP index, Y/Y"
    cn_roc_gdp_to_nn = cn_roc_gdp / cn_roc_nn;


!postprocessor(:production)

    cn_nch_to_ngdp = cn_pc * cn_ch / cn_ngdp;
    cn_nih_to_ngdp = cn_pih * cn_ih / cn_ngdp;
    cn_nkh_to_ngdp = cn_pk * cn_k / cn_ngdp;
    cn_curr_to_ngdp = ((cn_w*cn_nh*cn_nf - cn_txls2_to_nc*cn_pc*cn_ch)) / cn_ngdp;
    cn_gdp = cn_gdp{-1} * cn_roc_gdp;


!log-variables !all-but

    cn_nch_to_ngdp
    cn_nih_to_ngdp
    cn_nkh_to_ngdp
    cn_curr_to_ngdp


!variables(:monetary)

    "Nominal short-term rate, LCY" cn_r
    "Monetary policy reaction term" cn_react
    "Unconstrained nominal short-term rate, LCY" cn_unc_r
    "Nominal short-term rate for interest parity, LCY" cn_rip 


!parameters(:monetary :steady)

    "S/S Price of private consumption, Y/Y !! $\roc{\mathit{pc}}_\ss$" cn_ss_roc_pc
    "Switch for lower bound on short-term rate !! $\mathit{floor}$" cn_floor


!parameters(:monetary :dynamic)

    "A/R in policy rate !! $\rho_r$" cn_rho_r 
    "Monetary policy reaction to CPI !! $\psi_\mathit{pc}$" cn_psi_pc 
    "Monetary policy reaction to nominal exchange rate !! $\psi_e$" cn_psi_e
    "Monetary policy reaction to real economic activity !! $\psi_\mathit{nh}$" cn_psi_nh
    "Pressure relief valve for interest rate lower bound !! $\theta_\mathir{rip}$" cn_theta_rip


!shocks(:monetary)

    "Shock to monetary policy reaction function" cn_shk_r


!log-variables !all-but

    cn_react


!equations(:monetary)

    "Monetary policy reaction function"
    log(cn_unc_r) = + cn_rho_r * log(cn_r{-1}) + (1 - cn_rho_r) * [ log(&cn_unc_r) + cn_react ] + cn_shk_r !! cn_pc = cn_pc{-1} * cn_ss_roc_pc;


    "Monetary policy reaction term"
    cn_react = + cn_psi_pc * (log(cn_roc_pc{+1}) - log(cn_ss_roc_pc)) + cn_psi_e * (log(cn_roc_e) - log(&cn_roc_e)) + cn_psi_nh * (log(cn_nh{+1}) - log(&cn_nh)) !! cn_react = 0;


    "Zero floor constraint on policy rate"
    cn_r = cn_floor*max(1, cn_unc_r) + (1-cn_floor)*cn_unc_r !! cn_r = cn_unc_r;

    cn_rip = cn_r + cn_theta_rip*(cn_unc_r - cn_r) !! cn_rip = cn_r;


!variables

    "Government debt interest rate" cn_rg
    "Government consumption" cn_cg
    "Government debt to GDP ratio" cn_dg_to_ngdp
    "Net lump-sum tax 1 to consumption ratio" cn_txls1_to_nc
    "Net lump-sum tax 2 to consumption ratio" cn_txls2_to_nc
    "Government consumption, Y/Y" cn_roc_cg
    "Import tariff rate" cn_trm


!log-variables !all-but

    cn_txls1_to_nc, cn_txls2_to_nc, cn_dg_to_ngdp, cn_trm


!parameters(:fiscal :steady)

    "S/S Government debt to GDP ratio !! $\tratio{\mathit{dg}}{\mathit{ngdp}}_\ss$" cn_ss_dg_to_ngdp
    "S/S Government consumption to GDP ratio !! $\tratio{\mathit{ncg}}{\mathit{ngdp}}_\ss$" cn_ss_ncg_to_ngdp
    "S/S General import tariff rate !! $\mathit{trm}_\ss$" cn_ss_trm


!parameters(:fiscal :dynamic)

    "Response in government consumption to government debt !! $\tau_\mathit{cg}$" cn_tau_cg
    "Response in type 1 lump-sum tax rate to government debt !! $\tau_{\mathit{txls},1}$" cn_tau_txls1
    "Autoregression in government consumption !! $\rho_\mathit{cg}$" cn_rho_cg
    "Autoregression in type 1 lump-sum tax rate !! $\rho_{\mathit{txls},1}$" cn_rho_txls1
    "Autoregression in type 2 lump-sum tax rate !! $\rho_{\mathit{txls},2}$" cn_rho_txls2
    "Autoregression in generate import tariff rate !! $\rho_\mathit{trm}$" cn_rho_trm


!shocks

    "Shock to government consumption" cn_shk_cg
    "Shock to type 1 lump-sum taxes" cn_shk_txls1
    "Shock to type 2 lump-sum taxes" cn_shk_txls2
    "Shock to general import tariff rate" cn_shk_trm


!equations

    cn_rg = cn_r;

    
    "Dynamic fiscal budget constraint"
    cn_dg_to_ngdp*cn_ngdp = + cn_rg{-1}*cn_dg_to_ngdp{-1}*cn_ngdp{-1} + cn_pc*cn_cg - (cn_txls1_to_nc + cn_txls2_to_nc) * cn_pc*cn_ch - (cn_pmm - cn_fob_pmm) * cn_mm;


    "Fiscal reaction function for government consumption"
    log(cn_cg) = + cn_rho_cg * log(cn_cg{-1}*&cn_roc_cg) + (1 - cn_rho_cg) * log(cn_ss_ncg_to_ngdp*cn_ngdp/cn_pc) - cn_tau_cg * (cn_dg_to_ngdp{+1} - cn_ss_dg_to_ngdp) + cn_shk_cg !! cn_pc*cn_cg = cn_ss_ncg_to_ngdp*cn_ngdp;


    "Fiscal reaction function for type 1 net lump-sum taxes"
    cn_txls1_to_nc = + cn_rho_txls1 * cn_txls1_to_nc{-1} + (1-cn_rho_txls1) * &cn_txls1_to_nc + cn_tau_txls1 * (cn_dg_to_ngdp{+1} - cn_ss_dg_to_ngdp) + cn_shk_txls1 !! cn_dg_to_ngdp = cn_ss_dg_to_ngdp;


    "Fiscal reaction function for type 2 net lump-sum taxes"
    cn_txls2_to_nc = + cn_rho_txls2*cn_txls2_to_nc{-1} + cn_shk_txls2 !! cn_txls2_to_nc = 0;


    "Fiscal reaction function for import tariffs rate"
    cn_trm = + cn_rho_trm * cn_trm{-1} + (1 - cn_rho_trm) * cn_ss_trm + cn_shk_trm !! cn_trm = cn_ss_trm;


!variables(:open)

    "Non-commodity imports" cn_mm
    "Price of non-commodity imports" cn_pmm
    "Price of non-commodity imports, FOB" cn_fob_pmm
    "Imports for non-commodity exports" cn_mxx
    "Imports for domestic production" cn_my

    "Domestic content of non-commodity exports" cn_yxx
    "Non-commodity exports" cn_xx
    "Commodity exports" cn_xq
    "Price of non-commodity exports" cn_pxx

    "Net foreign fixed-income assets to GDP Ratio" cn_nfa_to_ngdp
    "Primary income rate on net foreign fixed-income assets" cn_rnfa
    "Checksum for net foreign fixed-income assets to GDP ratio" cn_nfa_to_ngdp_checksum
    "Nominal exchange rate" cn_e
    "Expectations of nominal exchange rate" cn_exp_e
    "Nominal Exchange Rate, Y/Y" cn_roc_e
    "BOP CA corporate equity primary income to GDP ratio" cn_bpceq_to_ngdp
    "BOP FA corporate equity transactions to GDP ratio" cn_bpfeq_to_ngdp
    "Price of non-commodity exports, Reference ccy" cn_pxx_rcy
    "Value of non-commodity exports, Reference ccy" cn_nxx_rcy
    "Net claims of financial sector on households" cn_bh_to_ngdp
    "Non-commodity imports to GDP ratio" cn_nmm_to_ngdp
    "Non-commodity exports to GDP ratio" cn_nxx_to_ngdp
    "Net commodity exports to GDP ratio" cn_netxq_to_ngdp
    "Net non-commodity exports to GDP ratio" cn_netxx_to_ngdp

    "Country credit risk" cn_zh
    "Autonomous component in country credit risk" cn_zh_aut


!log-variables !all-but

    cn_nfa_to_ngdp
    cn_nfa_to_ngdp_checksum
    cn_bpfeq_to_ngdp
    cn_bpceq_to_ngdp
    cn_bh_to_ngdp
    cn_nmm_to_ngdp
    cn_nxx_to_ngdp
    cn_netxq_to_ngdp
    cn_netxx_to_ngdp
    cn_zh_aut


!parameters(:open :steady)

    "Import intensity of non-commodity exports !! $\alpha$" cn_alpha
    "Acceleration in exportable productivity !! $\gamma_\mathit{xx}$" cn_gamma_xx
    "Elasticity of household risk function wrt NFA !! $\theta_1$" cn_theta_1
    "Curvature of household risk function wrt NFA !! $\theta_2$" cn_theta_2
    "Share of local commodity production in world commodity production !! $\lambda$" cn_lambda
    "S/S Autonomous component in country credit risk !! $\mathit{zh}^\mathrm{aut}_\ss$" cn_ss_zh_aut


!parameters(:open :dynamic)

    "A/R Autonomous component in country credit risk !! $\rho_{\mathit{zh}}^\mathrm{aut}$" cn_rho_zh_aut
    "Weight on model-consistent expectations in exchange rate !! $\zeta_e$" cn_zeta_e
    "Adjustment cost parameter in stage t-3 production !! $\xi_{y3}$" cn_xi_y3


!shocks(:open)

    "Interest parity shock" cn_shk_e
    "Shock to country credit risk" cn_shk_zh
    "Shock to autonoumous component in country credit risk" cn_shk_zh_aut


!equations(:open)


    "Distribution of non-commodity imports"
    cn_mm = cn_my + cn_mxx;


    "Commodity endowment"
    cn_xq = cn_lambda * gg_q;

    "Commodity prices in local currency"
    cn_pq = gg_pq * cn_e;


    "Non-commodity export production function"
    cn_xx = cn_ar^cn_gamma_xx * (cn_yxx/(1-cn_alpha))^(1-cn_alpha) * (cn_mxx/cn_alpha)^cn_alpha;

    "Demand for local content in export production"
    (1-cn_alpha) * cn_pxx * cn_xx = cn_py * cn_yxx;

    "Demand for re-exports"
    cn_alpha * cn_pxx * cn_xx = (cn_pmm * gg_dmm) * cn_mxx;


    "Balance of payments transactions"
    cn_nfa_to_ngdp * cn_ngdp - cn_nfa_to_ngdp{-1} * cn_ngdp{-1} = + cn_bpfeq_to_ngdp * cn_ngdp + (cn_rnfa - 1) * cn_nfa_to_ngdp{-1} * cn_ngdp{-1} + cn_bpceq_to_ngdp*cn_ngdp + cn_pxx * cn_xx - cn_fob_pmm * cn_mm + cn_netxq_to_ngdp * cn_ngdp + cn_nfa_to_ngdp_checksum * cn_ngdp;

    "Local interest spread"
    cn_zh = + cn_zh_aut + cn_theta_1 * (1/cn_theta_2)*[ exp(-cn_theta_2*cn_nfa_to_ngdp*cn_ngdp/(cn_pk*cn_k)) - 1 ] + cn_shk_zh;

    "Autonomous component in local interest spread"
    cn_zh_aut = + cn_rho_zh_aut * cn_zh_aut{-1} + (1 - cn_rho_zh_aut) * cn_ss_zh_aut + cn_shk_zh_aut !! cn_zh_aut = cn_ss_zh_aut;


    "Net balance sheet of local financial sector"
    cn_bh_to_ngdp + cn_dg_to_ngdp + cn_nfa_to_ngdp = 0;


    "Nominal Exchange Rate Expectations"
    cn_exp_e = cn_e{+1}^cn_zeta_e * (cn_e*&cn_roc_e)^(1-cn_zeta_e);


    cn_roc_e = cn_e / cn_e{-1};


    "Price of non-commodity exports in reference currency"
    cn_pxx_rcy = cn_pxx / cn_e;

    "Value of non-commodity exports in reference currency"
    cn_nxx_rcy = cn_pxx_rcy * cn_xx;


    "Total imports to GDP ratio"
    cn_nmm_to_ngdp = cn_fob_pmm*cn_mm / cn_ngdp;
    cn_nxx_to_ngdp = cn_pxx*cn_xx / cn_ngdp;
    cn_netxq_to_ngdp = cn_pq*(cn_xq - cn_mq) / cn_ngdp;
    cn_netxx_to_ngdp = cn_nxx_to_ngdp - cn_nmm_to_ngdp;


!postprocessor

    cn_nmxx_to_ngdp = cn_fob_pmm * cn_mxx / cn_ngdp;


!log-variables !all-but

    cn_nmm_to_ngdp
    cn_nxx_to_ngdp
    cn_nmxx_to_ngdp


!variables

    "Total population" rw_nn
    "Total population, Y/Y" rw_roc_nn
    "Area specific component in total population" rw_nr
    "Working age population" rw_nw
    "Labor force" rw_nf


!log-variables !all-but


!parameters(:demography :steady)

    "S/S Population, Relative to global population component !! $\mathit{nr}_\ss$" rw_ss_nr
    "S/S Share of working age population in total population !! $\tratio{\mathit{nw}}{\mathit{nn}}_\ss$" rw_ss_nw_to_nn
    "S/S Labor participation rate !! $\tratio{\mathit{nf}}{\mathit{nw}}_\ss$" rw_ss_nf_to_nw


!parameters(:demography :dynamic)

    "A/R Total population relative to global population component !! $\rho_\mathit{nr}$" rw_rho_nr
    "A/R Share of working age population in total population !! $\rho_\mathit{nw}$" rw_rho_nw
    "A/R Labor participation rate !! $\rho_\mathit{nf}$" rw_rho_nf


!shocks

    "Shock to relative population component" rw_shk_nr
    "Shock to share of working age population" rw_shk_nw_to_nn
    "Shock to labor participation rate" rw_shk_nf_to_nw


!equations

    "Total population relative to global population component"
    log(rw_nr) = rw_rho_nr * log(rw_nr{-1}) + (1-rw_rho_nr) * log(rw_ss_nr) + rw_shk_nr !! rw_nr = rw_ss_nr;


    "Total population"
    rw_nn = rw_nr * gg_nt;


    "Total population, Y/Y"
    rw_roc_nn = rw_nn / rw_nn{-1} !! rw_roc_nn = gg_ss_roc_nt;


    "Share of working age population"
    rw_nw/rw_nn = + rw_rho_nw * rw_nw{-1}/rw_nn{-1} + (1-rw_rho_nw) * rw_ss_nw_to_nn + rw_shk_nw_to_nn !! rw_nw = rw_ss_nw_to_nn * rw_nn;


    "Labor participation rate"
    rw_nf/rw_nw = + rw_rho_nf * rw_nf{-1}/rw_nw{-1} + (1-rw_rho_nf) * rw_ss_nf_to_nw + rw_shk_nf_to_nw !! rw_nf = rw_ss_nf_to_nw * rw_nw;


!variables(:households)

    "Private consumption" rw_ch
    "Per-capita private consumption" rw_ch_to_nn
    "Private consumption reference level" rw_ref_ch_to_ch
    "Real discount factor" rw_rdf
    "Per-worker labor supply" rw_nh
    "Private investment" rw_ih
    "Uncertainty in capital" rw_zk
    "Uncertainty in profits" rw_zy
    "Ex-post return on capital" rw_rk
    "Production capital" rw_k
    "Production capital services" rw_uk
    "Portfolio of claims on production capital" rw_kk
    "Household net worth" rw_netw
    "Nominal wage rate" rw_w
    "Real labor income" rw_rli

    "Price of production capital" rw_pk
    "Price of production capital services" rw_pu
    "Real consumer wage rate" rw_w_to_pc
    "Flexible nominal wage rate" rw_ww

    "Nominal wage rate, Y/Y" rw_roc_w
    "Household investment, Y/Y" rw_roc_ih
    "Production capital, Y/Y" rw_roc_k


!log-variables !all-but

    rw_ref_ch_to_ch


!parameters(:households :steady)

    "S/S Uncertainty discount factor on capital !! $\mathit{zk}_\mathrm{ss}$" rw_ss_zk
    "S/S Uncertainty discount factor on production cash flows !! $\mathit{zy}_\mathrm{ss}$" rw_ss_zy
    "Household discount factor !! $\beta$" rw_beta
    "Depreciation of production capital !! $\delta$" rw_delta
    "Inverse elasticity of labor supply !! $\eta$" rw_eta
    "Utility location parameter of labor supply !! $\eta_0$" rw_eta0
    "Intercept in current wealth utility !! $\nu_0$" rw_nu_0
    "Slope of current wealth utility !! $\nu_1$" rw_nu_1
    "Level parameter in cost of utilization of production capital !! $\upsilon_0$" rw_upsilon_0
    "Inverse elasticity of cost of utilization of production capital !! $\upsilon_1$" rw_upsilon_1


!parameters(:households :dynamic)

    "A/R in real wage rate !! $\rho_w$" rw_rho_w
    "A/R in uncertainty discount factor on capital !! $\rho_\mathit{zk}$" rw_rho_zk
    "A/R in uncertainty discount factor on production cash flows !! $\rho_\mathit{zy}$" rw_rho_zy
    "Point of reference in consuptions switch !! $\chi$" rw_chi
    "Past consumption in reference consumption parameter !! $\chi_\mathit{ch}$" rw_chi_ch
    "Current income in reference consumption parameter !! $\chi_\mathit{curr}$" rw_chi_curr
    "Type 1 investment adjustment cost parameter !! $\xi_\mathit{ih,1}$" rw_xi_ih1
    "Type 2 investment adjustment cost parameter !! $\xi_\mathit{ih,2}$" rw_xi_ih2
    "Pressure relief valve for interest rate lower bound !! $\theta_\mathir{rh}$" rw_theta_rh


!shocks(:households)

    "Shock to intertemporal preferences" rw_shk_beta
    "Shock to private consumption" rw_shk_ch
    "Shock to private investment" rw_shk_ih
    "Shock to wage rate" rw_shk_w
    "Shock to current income" rw_shk_curr
    "Shock to uncertainty discount factor on capital" rw_shk_zk
    "Shock to uncertainty discount factor on production cash flows" rw_shk_zy


!equations(:households)


    "Optimal choice of household consumption"
    rw_vh*rw_pc*(rw_ch - rw_chi*rw_ref_ch_to_ch*rw_ch)*exp(-rw_shk_ch) = rw_nn*(1 - rw_chi*&rw_ref_ch_to_ch) !! rw_vh*rw_pc*rw_ch = rw_nn;

    "Point of reference in household consumption" 
    rw_ref_ch_to_ch = [ rw_chi_curr*((rw_w*rw_nh*rw_nf - rw_txls2_to_nc*rw_pc*rw_ch))/rw_pc + rw_chi_ch*rw_ch{-1}*gg_ss_roc_a ] / rw_ch;

    "Optimal choice of net position with local financial sector"
    rw_vh = rw_beta*rw_vh{+1}*rw_rh + rw_nn/(rw_pc*rw_ch)*[ rw_nu_1*(rw_pc*rw_ch/rw_netw - rw_nu_0) - gg_nu ] * exp(rw_shk_beta) !! 1 = rw_beta*rw_rh/gg_ss_roc_a/rw_ss_roc_pc + rw_nu_1*rw_nch_to_netw_minus_nu_0 - gg_nu;

    "Auxiliary equation for steady-state calibration of nu_0"
    rw_nch_to_netw_minus_nu_0 = rw_pc * rw_ch / rw_netw - rw_nu_0;

    rw_rdf = rw_beta*rw_vh{+1}*rw_pc{+1}/(rw_vh*rw_pc);

    "Risk adjusted household rate"
    rw_rh = rw_r + rw_theta_rh*(rw_unc_r - rw_r) + rw_zh;

    "Current net worth of households"
    rw_netw = rw_kk + rw_dg_to_ngdp*rw_ngdp + rw_nfa_to_ngdp*rw_ngdp;

    "Uncertainty discount factor on capital"
    log(rw_zk) = rw_rho_zk*log(rw_zk{-1}) + (1-rw_rho_zk)*log(rw_ss_zk) + rw_shk_zk !! rw_zk = rw_ss_zk;

    "Uncertainty discount factor on production cash flows"
    log(rw_zy) = rw_rho_zy*log(rw_zy{-1}) + (1-rw_rho_zy)*log(rw_ss_zy) + rw_shk_zy !! rw_zy = rw_ss_zy;

    "Real labor income"
    rw_rli = rw_w*rw_nh*rw_nf / rw_pc; 


    "Optimal choice of per-worker hours worked"
    rw_vh * rw_ww = rw_eta0 * rw_nh^rw_eta;

    "Real consumer wage rate"
    rw_w_to_pc = rw_w / rw_pc;

    "Real wage rigidities"
    log(rw_w_to_pc) = + rw_rho_w * [log(rw_w_to_pc{-1}) + log(&rw_roc_w/&rw_roc_pc)] + (1-rw_rho_w) * log(rw_ww/rw_pc) + rw_shk_w !! rw_w = rw_ww;


    "Optimal choice of investment in local production capital"
    rw_pk * exp(rw_shk_ih) = rw_pih*[ 1 + rw_xi_ih1*(log(rw_ih) - log((&rw_ih/&rw_k*&rw_roc_k)*rw_k{-1})) + rw_xi_ih2*(log(rw_ih/rw_ih{-1}/&rw_roc_ih) - rw_beta*log(rw_ih{+1}/rw_ih/&rw_roc_ih)) ] !! rw_pk = rw_pih;

    "Accumulation of production capital"
    rw_k = (1-rw_delta)*rw_k{-1} + rw_ih;

    "Definition of utilized production capital"
    rw_uk = rw_u * rw_k;

    "Optimal choice of utilization rate of production capital"
    rw_py * rw_upsilon_0 * rw_u^rw_upsilon_1 = rw_pu;

    "Auxiliary equation for steady-state calibration of upsilon_0"
    rw_upsilon_1_py_to_pu = rw_upsilon_0 * rw_py / rw_pu;

    "Ex-post return on capital"
    rw_rk*rw_pk{-1} = rw_u{-1}*rw_pu{-1}*rw_rh{-1} + (1-rw_delta)*rw_pk;


        rw_roc_w = rw_w / rw_w{-1};
    
        rw_roc_ih = rw_ih / rw_ih{-1};
    
        rw_roc_k = rw_k / rw_k{-1};


!variables(:production)

    "Area specific productivity component" rw_ar
    "Shadow value of household budget constraing" rw_vh
    "Price of private consumption" rw_pc
    "Price of private investment" rw_pih
    "Domestic intermediate inputs" rw_yz
    "Stage T-3 output" rw_y3
    "Stage T-2 output" rw_y2
    "Stage T-1 output" rw_y1
    "Stage T-0 output" rw_y
    "Price of stage T-3 output" rw_py3
    "Price of state T-2 output" rw_py2
    "Price of state T-1 output" rw_py1
    "Price of stage T-0 output" rw_py0
    "Price of commodity input into production" rw_pq

    "Commodity input into production" rw_mq
    "Variable labor input into production" rw_nv

    "Nominal GDP" rw_ngdp
    "Real GDP index, Y/Y" rw_roc_gdp
    "Per-capita real GDP index, Y/Y" rw_roc_gdp_to_nn

    "Price of domestic production" rw_py
    "Nominal household rate, LCY" rw_rh

    "Price of final domestic output, Y/Y" rw_roc_py
    "Price of final domestic output, Y/Y, Point of reference" rw_ref_roc_py
    "Price of consumer goods, Y/Y" rw_roc_pc
    "Utilization rate of production capital" rw_u
    "Stage T-3 output, Y/Y" rw_roc_y3
    "Variable labor, Y/Y" rw_roc_nv

    "Auxiliary variable for steady-state calibration of upsilon_0" rw_upsilon_1_py_to_pu
    "Auxiliary equation for steady-state calibration of nu_0" rw_nch_to_netw_minus_nu_0


!log-variables !all-but

    rw_zh, rw_nch_to_netw_minus_nu_0


!parameters(:production :steady)

    "S/S Area specific productivity component !! $\mathit{ar}_\ss$" rw_ss_ar

    "Share of overhead labor !! $\gamma_\mathit{n0}$" rw_gamma_n0
    "Share of intermediate imports in stage T-3 production !! $\gamma_m$" rw_gamma_m
    "Share of capital services in stage T-2 production !! $\gamma_\mathit{uk}$" rw_gamma_uk
    "Share of commodity inputs in stage T-1 production !! $\gamma_q$" rw_gamma_q
    "Share of roundabout intermediates in stage T-0 production !! $\gamma_\mathit{yz}$" rw_gamma_yz

    "Monopoly power (markup) of local producers !! $\mu_\mathit{py}$" rw_mu_py
    "Markup to cover overhead labor !! $\mu_{y3}$" rw_mu_y3


!parameters(:production :dynamic)

    "Autoregression in area specific productivity component !! $\rho_\mathit{ar}$" rw_rho_ar
    "Weight on S/S inflation in inflation indexation !! $\zeta_\mathit{py}$" rw_zeta_py
    "Stage T-2 input factor adjustment cost parameter !! $\xi_{y2}$" rw_xi_y2
    "Stage T-1 input factor adjustment cost parameter !! $\xi_{y1}$" rw_xi_y1
    "Price adjustment cost parameters !! $\xi_\mathit{py}$" rw_xi_py


!shocks(:production)

    "Shock to area specific productivity component" rw_shk_ar
    "Shock to final price setting" rw_shk_py


!equations(:production)


    "Area-specific relative productivity component"
    log(rw_ar) = + rw_rho_ar * log(rw_ar{-1}) + (1 - rw_rho_ar) * log(rw_ss_ar) + rw_shk_ar !! rw_ar = rw_ss_ar;


    "Definition of variable labor input"
    rw_nv = (rw_nh - rw_gamma_n0*&rw_nh) * rw_nf;

    "Stage T-3 production function"
    rw_y3 = (rw_my/rw_gamma_m)^rw_gamma_m * ([rw_ar * gg_a * rw_nv]/(1-rw_gamma_m))^(1-rw_gamma_m);

    "Demand for intermediate imports"
    rw_gamma_m * rw_py3 * rw_y3 = (rw_pmm * gg_dmm) * rw_my * [1 + rw_xi_y3*((log(rw_my/rw_y3)-log(rw_my{-1}/rw_y3{-1}))-&rw_rdf*(log(rw_my{+1}/rw_y3{+1})-log(rw_my/rw_y3)))] !! rw_gamma_m * rw_py3 * rw_y3 = (rw_pmm * gg_dmm) * rw_my;

    "Demand for labor"
    (1-rw_gamma_m) * rw_py3 * rw_y3 = rw_mu_y3 * rw_w * rw_nv * [1 + rw_xi_y3*((log(rw_nv/rw_y3)-log(rw_nv{-1}/rw_y3{-1})-log(&rw_roc_nv/&rw_roc_y3))-&rw_rdf*(log(rw_nv{+1}/rw_y3{+1})-log(rw_nv/rw_y3)-log(&rw_roc_nv/&rw_roc_y3)))] !! (1-rw_gamma_m) * rw_py3 * rw_y3 = rw_mu_y3 * rw_w * rw_nv;


    rw_y2 = (rw_uk/rw_gamma_uk)^rw_gamma_uk * (rw_y3/(1-rw_gamma_uk))^(1-rw_gamma_uk);

    rw_gamma_uk * rw_py2 * rw_y2 = rw_pu * rw_uk * [1 + rw_xi_y2*((log(rw_uk/rw_y2)-log(rw_uk{-1}/rw_y2{-1}))-&rw_rdf*(log(rw_uk{+1}/rw_y2{+1})-log(rw_uk/rw_y2)))] !! rw_gamma_uk * rw_py2 * rw_y2 = rw_pu * rw_uk;

    (1-rw_gamma_uk) * rw_py2 * rw_y2 = rw_py3 * rw_y3 * [1 + rw_xi_y2*((log(rw_y3/rw_y2)-log(rw_y3{-1}/rw_y2{-1}))-&rw_rdf*(log(rw_y3{+1}/rw_y2{+1})-log(rw_y3/rw_y2)))] !! (1-rw_gamma_uk) * rw_py2 * rw_y2 = rw_py3 * rw_y3;


    rw_py1 = rw_py2^(1 - rw_gamma_q) * rw_pq^rw_gamma_q !! rw_y1 = (rw_y2/(1-rw_gamma_q))^(1-rw_gamma_q) * (rw_mq/rw_gamma_q)^rw_gamma_q;

        (1-rw_gamma_q) * &rw_py1 * rw_y1 = &rw_py2 * rw_y2 !! (1-rw_gamma_q) * rw_py1 * rw_y1 = rw_py2 * rw_y2 ;

        (rw_gamma_q) * &rw_py1 * rw_y1 = &rw_pq * rw_mq !! rw_gamma_q * rw_py1 * rw_y1 = rw_pq * rw_mq ;


    rw_y = rw_y1;
    rw_py0 = rw_py1;
    rw_yz = 1;


    rw_mu_py*rw_py0*exp(rw_shk_py) = rw_py*[1 + (rw_mu_py-1)*rw_xi_py*(log(rw_roc_py/rw_ref_roc_py) - rw_beta*gg_zy*rw_zy*log(rw_roc_py{+1}/rw_ref_roc_py{+1}))] !! rw_py = rw_mu_py * rw_py0;

    rw_ref_roc_py = rw_roc_py{-1}^(1-rw_zeta_py) * &rw_roc_py^rw_zeta_py;

    rw_pc = rw_py;
    rw_pih = rw_py;


    rw_y = rw_ch + rw_cg + rw_ih + rw_yxx;


        rw_roc_cg = rw_cg / rw_cg{-1};
    
        rw_roc_pc = rw_pc / rw_pc{-1};
    
        rw_roc_py = rw_py / rw_py{-1};
    
        rw_roc_y3 = rw_y3 / rw_y3{-1};
    
        rw_roc_nv = rw_nv / rw_nv{-1};


    "Per-capita private consumption"
    rw_ch_to_nn = rw_ch / rw_nn;

    "Nominal GDP"
    rw_ngdp = rw_pc*rw_ch + rw_pih*rw_ih + rw_pc*rw_cg + rw_pxx*rw_xx - rw_pmm*rw_mm + rw_pq*(rw_xq - rw_mq);

    "Real GDP index, Y/Y"
    rw_roc_gdp = + (rw_pc*rw_ch/rw_ngdp + rw_pc{-1}*rw_ch{-1}/rw_ngdp{-1})/2 * ((rw_ch)/(rw_ch{-1})) + (rw_pih*rw_ih/rw_ngdp + rw_pih{-1}*rw_ih{-1}/rw_ngdp{-1})/2 * ((rw_ih)/(rw_ih{-1})) + (rw_pc*rw_cg/rw_ngdp + rw_pc{-1}*rw_cg{-1}/rw_ngdp{-1})/2 * ((rw_cg)/(rw_cg{-1})) + (rw_pxx*rw_xx/rw_ngdp + rw_pxx{-1}*rw_xx{-1}/rw_ngdp{-1})/2 * ((rw_xx)/(rw_xx{-1})) - (rw_pmm*rw_mm/rw_ngdp + rw_pmm{-1}*rw_mm{-1}/rw_ngdp{-1})/2 * ((rw_mm)/(rw_mm{-1})) + (rw_pq*rw_xq/rw_ngdp + rw_pq{-1}*rw_xq{-1}/rw_ngdp{-1})/2 * ((rw_xq)/(rw_xq{-1})) - (rw_pq*rw_mq/rw_ngdp + rw_pq{-1}*rw_mq{-1}/rw_ngdp{-1})/2 * ((rw_mq)/(rw_mq{-1})) !! rw_roc_gdp = gg_ss_roc_a * gg_ss_roc_nt;

    "Per-capita real GDP index, Y/Y"
    rw_roc_gdp_to_nn = rw_roc_gdp / rw_roc_nn;


!postprocessor(:production)

    rw_nch_to_ngdp = rw_pc * rw_ch / rw_ngdp;
    rw_nih_to_ngdp = rw_pih * rw_ih / rw_ngdp;
    rw_nkh_to_ngdp = rw_pk * rw_k / rw_ngdp;
    rw_curr_to_ngdp = ((rw_w*rw_nh*rw_nf - rw_txls2_to_nc*rw_pc*rw_ch)) / rw_ngdp;
    rw_gdp = rw_gdp{-1} * rw_roc_gdp;


!log-variables !all-but

    rw_nch_to_ngdp
    rw_nih_to_ngdp
    rw_nkh_to_ngdp
    rw_curr_to_ngdp


!variables(:monetary)

    "Nominal short-term rate, LCY" rw_r
    "Monetary policy reaction term" rw_react
    "Unconstrained nominal short-term rate, LCY" rw_unc_r
    "Nominal short-term rate for interest parity, LCY" rw_rip 


!parameters(:monetary :steady)

    "S/S Price of private consumption, Y/Y !! $\roc{\mathit{pc}}_\ss$" rw_ss_roc_pc
    "Switch for lower bound on short-term rate !! $\mathit{floor}$" rw_floor


!parameters(:monetary :dynamic)

    "A/R in policy rate !! $\rho_r$" rw_rho_r 
    "Monetary policy reaction to CPI !! $\psi_\mathit{pc}$" rw_psi_pc 
    "Monetary policy reaction to nominal exchange rate !! $\psi_e$" rw_psi_e
    "Monetary policy reaction to real economic activity !! $\psi_\mathit{nh}$" rw_psi_nh
    "Pressure relief valve for interest rate lower bound !! $\theta_\mathir{rip}$" rw_theta_rip


!shocks(:monetary)

    "Shock to monetary policy reaction function" rw_shk_r


!log-variables !all-but

    rw_react


!equations(:monetary)

    "Monetary policy reaction function"
    log(rw_unc_r) = + rw_rho_r * log(rw_r{-1}) + (1 - rw_rho_r) * [ log(&rw_unc_r) + rw_react ] + rw_shk_r !! rw_pc = rw_pc{-1} * rw_ss_roc_pc;


    "Monetary policy reaction term"
    rw_react = + rw_psi_pc * (log(rw_roc_pc{+1}) - log(rw_ss_roc_pc)) + rw_psi_e * (log(rw_roc_e) - log(&rw_roc_e)) + rw_psi_nh * (log(rw_nh{+1}) - log(&rw_nh)) !! rw_react = 0;


    "Zero floor constraint on policy rate"
    rw_r = rw_floor*max(1, rw_unc_r) + (1-rw_floor)*rw_unc_r !! rw_r = rw_unc_r;

    rw_rip = rw_r + rw_theta_rip*(rw_unc_r - rw_r) !! rw_rip = rw_r;


!variables

    "Government debt interest rate" rw_rg
    "Government consumption" rw_cg
    "Government debt to GDP ratio" rw_dg_to_ngdp
    "Net lump-sum tax 1 to consumption ratio" rw_txls1_to_nc
    "Net lump-sum tax 2 to consumption ratio" rw_txls2_to_nc
    "Government consumption, Y/Y" rw_roc_cg
    "Import tariff rate" rw_trm


!log-variables !all-but

    rw_txls1_to_nc, rw_txls2_to_nc, rw_dg_to_ngdp, rw_trm


!parameters(:fiscal :steady)

    "S/S Government debt to GDP ratio !! $\tratio{\mathit{dg}}{\mathit{ngdp}}_\ss$" rw_ss_dg_to_ngdp
    "S/S Government consumption to GDP ratio !! $\tratio{\mathit{ncg}}{\mathit{ngdp}}_\ss$" rw_ss_ncg_to_ngdp
    "S/S General import tariff rate !! $\mathit{trm}_\ss$" rw_ss_trm


!parameters(:fiscal :dynamic)

    "Response in government consumption to government debt !! $\tau_\mathit{cg}$" rw_tau_cg
    "Response in type 1 lump-sum tax rate to government debt !! $\tau_{\mathit{txls},1}$" rw_tau_txls1
    "Autoregression in government consumption !! $\rho_\mathit{cg}$" rw_rho_cg
    "Autoregression in type 1 lump-sum tax rate !! $\rho_{\mathit{txls},1}$" rw_rho_txls1
    "Autoregression in type 2 lump-sum tax rate !! $\rho_{\mathit{txls},2}$" rw_rho_txls2
    "Autoregression in generate import tariff rate !! $\rho_\mathit{trm}$" rw_rho_trm


!shocks

    "Shock to government consumption" rw_shk_cg
    "Shock to type 1 lump-sum taxes" rw_shk_txls1
    "Shock to type 2 lump-sum taxes" rw_shk_txls2
    "Shock to general import tariff rate" rw_shk_trm


!equations

    rw_rg = rw_r;

    
    "Dynamic fiscal budget constraint"
    rw_dg_to_ngdp*rw_ngdp = + rw_rg{-1}*rw_dg_to_ngdp{-1}*rw_ngdp{-1} + rw_pc*rw_cg - (rw_txls1_to_nc + rw_txls2_to_nc) * rw_pc*rw_ch - (rw_pmm - rw_fob_pmm) * rw_mm;


    "Fiscal reaction function for government consumption"
    log(rw_cg) = + rw_rho_cg * log(rw_cg{-1}*&rw_roc_cg) + (1 - rw_rho_cg) * log(rw_ss_ncg_to_ngdp*rw_ngdp/rw_pc) - rw_tau_cg * (rw_dg_to_ngdp{+1} - rw_ss_dg_to_ngdp) + rw_shk_cg !! rw_pc*rw_cg = rw_ss_ncg_to_ngdp*rw_ngdp;


    "Fiscal reaction function for type 1 net lump-sum taxes"
    rw_txls1_to_nc = + rw_rho_txls1 * rw_txls1_to_nc{-1} + (1-rw_rho_txls1) * &rw_txls1_to_nc + rw_tau_txls1 * (rw_dg_to_ngdp{+1} - rw_ss_dg_to_ngdp) + rw_shk_txls1 !! rw_dg_to_ngdp = rw_ss_dg_to_ngdp;


    "Fiscal reaction function for type 2 net lump-sum taxes"
    rw_txls2_to_nc = + rw_rho_txls2*rw_txls2_to_nc{-1} + rw_shk_txls2 !! rw_txls2_to_nc = 0;


    "Fiscal reaction function for import tariffs rate"
    rw_trm = + rw_rho_trm * rw_trm{-1} + (1 - rw_rho_trm) * rw_ss_trm + rw_shk_trm !! rw_trm = rw_ss_trm;


!variables(:open)

    "Non-commodity imports" rw_mm
    "Price of non-commodity imports" rw_pmm
    "Price of non-commodity imports, FOB" rw_fob_pmm
    "Imports for non-commodity exports" rw_mxx
    "Imports for domestic production" rw_my

    "Domestic content of non-commodity exports" rw_yxx
    "Non-commodity exports" rw_xx
    "Commodity exports" rw_xq
    "Price of non-commodity exports" rw_pxx

    "Net foreign fixed-income assets to GDP Ratio" rw_nfa_to_ngdp
    "Primary income rate on net foreign fixed-income assets" rw_rnfa
    "Checksum for net foreign fixed-income assets to GDP ratio" rw_nfa_to_ngdp_checksum
    "Nominal exchange rate" rw_e
    "Expectations of nominal exchange rate" rw_exp_e
    "Nominal Exchange Rate, Y/Y" rw_roc_e
    "BOP CA corporate equity primary income to GDP ratio" rw_bpceq_to_ngdp
    "BOP FA corporate equity transactions to GDP ratio" rw_bpfeq_to_ngdp
    "Price of non-commodity exports, Reference ccy" rw_pxx_rcy
    "Value of non-commodity exports, Reference ccy" rw_nxx_rcy
    "Net claims of financial sector on households" rw_bh_to_ngdp
    "Non-commodity imports to GDP ratio" rw_nmm_to_ngdp
    "Non-commodity exports to GDP ratio" rw_nxx_to_ngdp
    "Net commodity exports to GDP ratio" rw_netxq_to_ngdp
    "Net non-commodity exports to GDP ratio" rw_netxx_to_ngdp

    "Country credit risk" rw_zh
    "Autonomous component in country credit risk" rw_zh_aut


!log-variables !all-but

    rw_nfa_to_ngdp
    rw_nfa_to_ngdp_checksum
    rw_bpfeq_to_ngdp
    rw_bpceq_to_ngdp
    rw_bh_to_ngdp
    rw_nmm_to_ngdp
    rw_nxx_to_ngdp
    rw_netxq_to_ngdp
    rw_netxx_to_ngdp
    rw_zh_aut


!parameters(:open :steady)

    "Import intensity of non-commodity exports !! $\alpha$" rw_alpha
    "Acceleration in exportable productivity !! $\gamma_\mathit{xx}$" rw_gamma_xx
    "Elasticity of household risk function wrt NFA !! $\theta_1$" rw_theta_1
    "Curvature of household risk function wrt NFA !! $\theta_2$" rw_theta_2
    "Share of local commodity production in world commodity production !! $\lambda$" rw_lambda
    "S/S Autonomous component in country credit risk !! $\mathit{zh}^\mathrm{aut}_\ss$" rw_ss_zh_aut


!parameters(:open :dynamic)

    "A/R Autonomous component in country credit risk !! $\rho_{\mathit{zh}}^\mathrm{aut}$" rw_rho_zh_aut
    "Weight on model-consistent expectations in exchange rate !! $\zeta_e$" rw_zeta_e
    "Adjustment cost parameter in stage t-3 production !! $\xi_{y3}$" rw_xi_y3


!shocks(:open)

    "Interest parity shock" rw_shk_e
    "Shock to country credit risk" rw_shk_zh
    "Shock to autonoumous component in country credit risk" rw_shk_zh_aut


!equations(:open)


    "Distribution of non-commodity imports"
    rw_mm = rw_my + rw_mxx;


    "Commodity endowment"
    rw_xq = rw_lambda * gg_q;

    "Commodity prices in local currency"
    rw_pq = gg_pq * rw_e;


    "Non-commodity export production function"
    rw_xx = rw_ar^rw_gamma_xx * (rw_yxx/(1-rw_alpha))^(1-rw_alpha) * (rw_mxx/rw_alpha)^rw_alpha;

    "Demand for local content in export production"
    (1-rw_alpha) * rw_pxx * rw_xx = rw_py * rw_yxx;

    "Demand for re-exports"
    rw_alpha * rw_pxx * rw_xx = (rw_pmm * gg_dmm) * rw_mxx;


    "Balance of payments transactions"
    rw_nfa_to_ngdp * rw_ngdp - rw_nfa_to_ngdp{-1} * rw_ngdp{-1} = + rw_bpfeq_to_ngdp * rw_ngdp + (rw_rnfa - 1) * rw_nfa_to_ngdp{-1} * rw_ngdp{-1} + rw_bpceq_to_ngdp*rw_ngdp + rw_pxx * rw_xx - rw_fob_pmm * rw_mm + rw_netxq_to_ngdp * rw_ngdp + rw_nfa_to_ngdp_checksum * rw_ngdp;

    "Local interest spread"
    rw_zh = + rw_zh_aut + rw_theta_1 * (1/rw_theta_2)*[ exp(-rw_theta_2*rw_nfa_to_ngdp*rw_ngdp/(rw_pk*rw_k)) - 1 ] + rw_shk_zh;

    "Autonomous component in local interest spread"
    rw_zh_aut = + rw_rho_zh_aut * rw_zh_aut{-1} + (1 - rw_rho_zh_aut) * rw_ss_zh_aut + rw_shk_zh_aut !! rw_zh_aut = rw_ss_zh_aut;


    "Net balance sheet of local financial sector"
    rw_bh_to_ngdp + rw_dg_to_ngdp + rw_nfa_to_ngdp = 0;


    "Nominal Exchange Rate Expectations"
    rw_exp_e = rw_e{+1}^rw_zeta_e * (rw_e*&rw_roc_e)^(1-rw_zeta_e);


    rw_roc_e = rw_e / rw_e{-1};


    "Price of non-commodity exports in reference currency"
    rw_pxx_rcy = rw_pxx / rw_e;

    "Value of non-commodity exports in reference currency"
    rw_nxx_rcy = rw_pxx_rcy * rw_xx;


    "Total imports to GDP ratio"
    rw_nmm_to_ngdp = rw_fob_pmm*rw_mm / rw_ngdp;
    rw_nxx_to_ngdp = rw_pxx*rw_xx / rw_ngdp;
    rw_netxq_to_ngdp = rw_pq*(rw_xq - rw_mq) / rw_ngdp;
    rw_netxx_to_ngdp = rw_nxx_to_ngdp - rw_nmm_to_ngdp;


!postprocessor

    rw_nmxx_to_ngdp = rw_fob_pmm * rw_mxx / rw_ngdp;


!log-variables !all-but

    rw_nmm_to_ngdp
    rw_nxx_to_ngdp
    rw_nmxx_to_ngdp


!variables(:global)

    "Global productivity trend component" gg_a
    "Global productivity trend component, Y/Y" gg_roc_a
    "Global population trend component" gg_nt
    "Global uncertainty in capital" gg_zk
    "Global uncertainty in profits" gg_zy
    "Global disruption to non-commodity trade" gg_dmm


!shocks(:global)

    "Shock to global productivity trend" gg_shk_a
    "Shock to global population trend" gg_shk_nn
    "Shock to global uncertainty in capital" gg_shk_zk
    "Shock to global uncertainty in profits" gg_shk_zy
    "Shock to global disruption to non-commodity trade" gg_shk_dmm


!parameters(:global :steady)

    "S/S Global productivity trend, Y/Y !! $\roc{a}^\gg_\ss$" gg_ss_roc_a
    "S/S Global population trend, Y/Y !! $\roc{\mathit{nt}}^\gg_\ss$" gg_ss_roc_nt
    "S/S Global uncertainty discount factor on capital !! $\mathit{zk}^\gg_\ss$" gg_ss_zk
    "S/S Global uncertainty discount factor on production cash flows !! $\mathit{zy}^\gg_\ss$" gg_ss_zy
    "S/S Global disruption to non-commodity trade !! $\mathit{dmm}^\gg_\ss$" gg_ss_dmm

    "Global intercept in Euler equation !! $\nu^\gg$" gg_nu


!parameters(:global :dynamic)

    "A/R in global productivity trend !! $\rho_a^\gg$" gg_rho_a
    "A/R in global population trend !! $\rho_\mathit{nt}^\gg$" gg_rho_nt
    "A/R in uncertainty discount factor on capital !! $\rho_\mathit{zk}^\gg$" gg_rho_zk
    "A/R in uncertainty discount factor on production cash flows !! $\rho_\mathit{zy}^\gg$" gg_rho_zy
    "A/R Global disruption to non-commodity trade !! $\rho_\mathit{dmm}^\gg$" gg_rho_dmm


!log-variables !all-but


!equations(:global)

    "Global productivity trend, Y/Y"
    log(gg_roc_a) = + gg_rho_a * log(gg_roc_a{-1}) + (1 - gg_rho_a)*(log(gg_ss_roc_a) + gg_shk_a) !! gg_roc_a = gg_ss_roc_a;


    "Global productivity trend"
    gg_a = gg_a{-1} * gg_roc_a !! gg_a = gg_a{-1} * gg_ss_roc_a;


    "Global population trend"
    (log(gg_nt)-log(gg_nt{-1})) = + gg_rho_a * (log(gg_nt{-1})-log(gg_nt{-1-1})) + (1-gg_rho_a) * (log(gg_ss_roc_nt) + gg_shk_nn) !! gg_nt = gg_nt{-1} * gg_ss_roc_nt;


    "Global uncertainty discount factor on capital"
    log(gg_zk) = gg_rho_zk*log(gg_zk{-1}) + (1-gg_rho_zk)*log(gg_ss_zk) + gg_shk_zk !! gg_zk = gg_ss_zk;


    "Global uncertainty discount factor on production cash flows"
    log(gg_zy) = gg_rho_zy*log(gg_zy{-1}) + (1-gg_rho_zy)*log(gg_ss_zy) + gg_shk_zy !! gg_zy = gg_ss_zy;


    "Global disruption to non-commodity trade"
    log(gg_dmm) = + gg_rho_dmm * log(gg_dmm{-1}) + (1 - gg_rho_dmm) * log(gg_ss_dmm) + gg_shk_dmm !! gg_dmm = gg_ss_dmm;


!variables

    "Global population" gg_nn
    "Global population, Y/Y" gg_roc_nn
    "Global index of non-commodity export prices" gg_pxx
    "Global nominal GDP" gg_ngdp
    "Global real GDP index, Y/Y" gg_roc_gdp
    "Global per-capita real GDP index, Y/Y" gg_roc_gdp_to_nn


!parameters
    
        "Forex market functioning" ea_zeta_r
    
        "Forex market functioning" cn_zeta_r
    
        "Forex market functioning" rw_zeta_r


!equations


    "Net asset clearing"
    0 = + us_nfa_to_ngdp * us_ngdp / us_e + ea_nfa_to_ngdp * ea_ngdp / ea_e + cn_nfa_to_ngdp * cn_ngdp / cn_e + rw_nfa_to_ngdp * rw_ngdp / rw_e ;

    
        "Interest parity"
        ea_rip = us_rip * (ea_exp_e / ea_e * exp(ea_shk_e))^(1/ea_zeta_r) * (&ea_roc_e)^(1-1/ea_zeta_r);

        "Effective NFA rate"
        ea_rnfa = us_r{-1} * ea_e / ea_e{-1};

        "NFA checksum"
        ea_nfa_to_ngdp_checksum = 0;
    
        "Interest parity"
        cn_rip = us_rip * (cn_exp_e / cn_e * exp(cn_shk_e))^(1/cn_zeta_r) * (&cn_roc_e)^(1-1/cn_zeta_r);

        "Effective NFA rate"
        cn_rnfa = us_r{-1} * cn_e / cn_e{-1};

        "NFA checksum"
        cn_nfa_to_ngdp_checksum = 0;
    
        "Interest parity"
        rw_rip = us_rip * (rw_exp_e / rw_e * exp(rw_shk_e))^(1/rw_zeta_r) * (&rw_roc_e)^(1-1/rw_zeta_r);

        "Effective NFA rate"
        rw_rnfa = us_r{-1} * rw_e / rw_e{-1};

        "NFA checksum"
        rw_nfa_to_ngdp_checksum = 0;
    

    "Global reference currency effective NFA rate"
    us_rnfa = us_r{-1};

    "Reference currency exchange rate"
    us_e = 1;

    "Global population"
    gg_nn = + us_nn + ea_nn + cn_nn + rw_nn ;

    "Global population, rate of change"
    gg_roc_nn = gg_nn / gg_nn{-1};

    "Global index of non-commodity export prices"
    gg_pxx = ( + us_pxx_rcy * us_nxx_rcy + ea_pxx_rcy * ea_nxx_rcy + cn_pxx_rcy * cn_nxx_rcy + rw_pxx_rcy * rw_nxx_rcy ) / ( + us_nxx_rcy + ea_nxx_rcy + cn_nxx_rcy + rw_nxx_rcy ) ;

    "Global demand for commodities"
    gg_q = + us_mq + ea_mq + cn_mq + rw_mq ;


    "Global nominal GDP"
    gg_ngdp = + us_ngdp_rcy + ea_ngdp_rcy + cn_ngdp_rcy + rw_ngdp_rcy ;

    "Global real GDP, Y/Y"
    gg_roc_gdp = + (us_ngdp_rcy/gg_ngdp + us_ngdp_rcy{-1}/gg_ngdp{-1})/2 * us_roc_gdp + (ea_ngdp_rcy/gg_ngdp + ea_ngdp_rcy{-1}/gg_ngdp{-1})/2 * ea_roc_gdp + (cn_ngdp_rcy/gg_ngdp + cn_ngdp_rcy{-1}/gg_ngdp{-1})/2 * cn_roc_gdp + (rw_ngdp_rcy/gg_ngdp + rw_ngdp_rcy{-1}/gg_ngdp{-1})/2 * rw_roc_gdp ;

    "Global per-capita real GDP, Y/Y"
    gg_roc_gdp_to_nn = gg_roc_gdp / gg_roc_nn; 


    !variables
        "Nominal GDP, Reference currency [us]" us_ngdp_rcy
        "Per-capita private consumption" us_comp_ch_to_nn
        "Per-capita gross production" us_comp_y_to_nn
    !equations
        us_ngdp_rcy = us_ngdp / us_e;
        us_comp_ch_to_nn = (us_ch / us_nn) / (us_ch / us_nn);
        us_comp_y_to_nn = (us_y / us_nn) / (us_y / us_nn);

    !variables
        "Nominal GDP, Reference currency [ea]" ea_ngdp_rcy
        "Per-capita private consumption" ea_comp_ch_to_nn
        "Per-capita gross production" ea_comp_y_to_nn
    !equations
        ea_ngdp_rcy = ea_ngdp / ea_e;
        ea_comp_ch_to_nn = (ea_ch / ea_nn) / (us_ch / us_nn);
        ea_comp_y_to_nn = (ea_y / ea_nn) / (us_y / us_nn);

    !variables
        "Nominal GDP, Reference currency [cn]" cn_ngdp_rcy
        "Per-capita private consumption" cn_comp_ch_to_nn
        "Per-capita gross production" cn_comp_y_to_nn
    !equations
        cn_ngdp_rcy = cn_ngdp / cn_e;
        cn_comp_ch_to_nn = (cn_ch / cn_nn) / (us_ch / us_nn);
        cn_comp_y_to_nn = (cn_y / cn_nn) / (us_y / us_nn);

    !variables
        "Nominal GDP, Reference currency [rw]" rw_ngdp_rcy
        "Per-capita private consumption" rw_comp_ch_to_nn
        "Per-capita gross production" rw_comp_y_to_nn
    !equations
        rw_ngdp_rcy = rw_ngdp / rw_e;
        rw_comp_ch_to_nn = (rw_ch / rw_nn) / (us_ch / us_nn);
        rw_comp_y_to_nn = (rw_y / rw_nn) / (us_y / us_nn);


!variables(:commodity)

    "Long-run level of commodity supply" gg_qq
    "Global commodity demand" gg_q
    "Global excess demand in commodity market" gg_qexc
    "Global price of commodities" gg_pq
    "Global real price of commodities" gg_pq_to_pxx


!log-variables !all-but


!parameters(:commodity :dynamic)

    "Excess demand elasticity of commodity prices !! $\iota_1^\gg$" gg_iota_1
    "A/R Long-run trend in commodity supply !! $\rho_\mathit{qq}^\gg$" gg_rho_qq


!shocks(:commodity)

    "Shock to long-run level in commodity supply" gg_shk_qq
    "Shock to price of commodities" gg_shk_pq


!equations(:commodity)

    "Long-run level of global commodity production"
    log(gg_qq) = + gg_rho_qq * log(gg_ss_roc_a * gg_ss_roc_nt * gg_qq{-1}) + (1 - gg_rho_qq) * log(gg_a * gg_nn * (&gg_q / &gg_a / &gg_nn)) + gg_shk_qq !! gg_qq = gg_q;


    "Log excess demand in commodity market"
    gg_qexc = gg_q / gg_qq !! gg_qexc = 1;


    "Commodity supply curve"
    gg_pq = gg_pxx * gg_qexc^gg_iota_1 * exp(gg_shk_pq) !! gg_pq = gg_pxx;


    "Global real prices of commodities"
    gg_pq_to_pxx = gg_pq / gg_pxx;


!variables
    
        
            "Share of real imports from [cn] in total real imports to [?]"
            us_mm_sh_cn
        
            "Share of real imports from [ea] in total real imports to [?]"
            us_mm_sh_ea
        
            "Share of real imports from [rw] in total real imports to [?]"
            us_mm_sh_rw


            "Share of real imports from [cn] in total real imports to [?]"
            ea_mm_sh_cn
        
            "Share of real imports from [rw] in total real imports to [?]"
            ea_mm_sh_rw
        
            "Share of real imports from [us] in total real imports to [?]"
            ea_mm_sh_us


            "Share of real imports from [ea] in total real imports to [?]"
            cn_mm_sh_ea
        
            "Share of real imports from [rw] in total real imports to [?]"
            cn_mm_sh_rw
        
            "Share of real imports from [us] in total real imports to [?]"
            cn_mm_sh_us


            "Share of real imports from [cn] in total real imports to [?]"
            rw_mm_sh_cn
        
            "Share of real imports from [ea] in total real imports to [?]"
            rw_mm_sh_ea
        
            "Share of real imports from [us] in total real imports to [?]"
            rw_mm_sh_us


!log-variables !all-but


            us_mm_sh_cn
            us_trm_cn
        
            us_mm_sh_ea
            us_trm_ea
        
            us_mm_sh_rw
            us_trm_rw


            ea_mm_sh_cn
            ea_trm_cn
        
            ea_mm_sh_rw
            ea_trm_rw
        
            ea_mm_sh_us
            ea_trm_us


            cn_mm_sh_ea
            cn_trm_ea
        
            cn_mm_sh_rw
            cn_trm_rw
        
            cn_mm_sh_us
            cn_trm_us


            rw_mm_sh_cn
            rw_trm_cn
        
            rw_mm_sh_ea
            rw_trm_ea
        
            rw_mm_sh_us
            rw_trm_us


!parameters

    
        "Point of origination import adjustment costs !! $\xi_\mathit{mm}$"
        us_xi_mm

        
            "Share of nominal imports from [cn] in total [us] nominal imports !! $\omega_\mathrm{cn}$"
            us_omega_cn
        
            "Share of nominal imports from [ea] in total [us] nominal imports !! $\omega_\mathrm{ea}$"
            us_omega_ea
        
            "Share of nominal imports from [rw] in total [us] nominal imports !! $\omega_\mathrm{rw}$"
            us_omega_rw
        
    
        "Point of origination import adjustment costs !! $\xi_\mathit{mm}$"
        ea_xi_mm

        
            "Share of nominal imports from [cn] in total [ea] nominal imports !! $\omega_\mathrm{cn}$"
            ea_omega_cn
        
            "Share of nominal imports from [rw] in total [ea] nominal imports !! $\omega_\mathrm{rw}$"
            ea_omega_rw
        
            "Share of nominal imports from [us] in total [ea] nominal imports !! $\omega_\mathrm{us}$"
            ea_omega_us
        
    
        "Point of origination import adjustment costs !! $\xi_\mathit{mm}$"
        cn_xi_mm

        
            "Share of nominal imports from [ea] in total [cn] nominal imports !! $\omega_\mathrm{ea}$"
            cn_omega_ea
        
            "Share of nominal imports from [rw] in total [cn] nominal imports !! $\omega_\mathrm{rw}$"
            cn_omega_rw
        
            "Share of nominal imports from [us] in total [cn] nominal imports !! $\omega_\mathrm{us}$"
            cn_omega_us
        
    
        "Point of origination import adjustment costs !! $\xi_\mathit{mm}$"
        rw_xi_mm

        
            "Share of nominal imports from [cn] in total [rw] nominal imports !! $\omega_\mathrm{cn}$"
            rw_omega_cn
        
            "Share of nominal imports from [ea] in total [rw] nominal imports !! $\omega_\mathrm{ea}$"
            rw_omega_ea
        
            "Share of nominal imports from [us] in total [rw] nominal imports !! $\omega_\mathrm{us}$"
            rw_omega_us


!equations

    
        "Distribution of exports across areas"
        us_xx = + cn_mm * cn_mm_sh_us + ea_mm * ea_mm_sh_us + rw_mm * rw_mm_sh_us ;
    
        "Distribution of exports across areas"
        ea_xx = + cn_mm * cn_mm_sh_ea + rw_mm * rw_mm_sh_ea + us_mm * us_mm_sh_ea ;
    
        "Distribution of exports across areas"
        cn_xx = + ea_mm * ea_mm_sh_cn + rw_mm * rw_mm_sh_cn + us_mm * us_mm_sh_cn ;
    
        "Distribution of exports across areas"
        rw_xx = + cn_mm * cn_mm_sh_rw + ea_mm * ea_mm_sh_rw + us_mm * us_mm_sh_rw ;


        "Assembly of total non-commodity imports"
        1 = 1 * (us_mm_sh_cn / us_omega_cn)^us_omega_cn * (us_mm_sh_ea / us_omega_ea)^us_omega_ea * (us_mm_sh_rw / us_omega_rw)^us_omega_rw ;


            "Demand for imports from [cn] in total [us] non-commodity imports"
            us_omega_cn * us_pmm = (us_e / cn_e) * cn_pxx * (1 + us_trm + us_trm_cn) * us_mm_sh_cn * [1 + us_xi_mm*(log(us_mm_sh_cn)-log(us_mm_sh_cn{-1})) - us_rdf*(log(us_mm_sh_cn{+1})-log(us_mm_sh_cn))] !! us_omega_cn * us_pmm = (us_e / cn_e) * cn_pxx * (1 + us_trm + us_trm_cn) * us_mm_sh_cn;
        
            "Demand for imports from [ea] in total [us] non-commodity imports"
            us_omega_ea * us_pmm = (us_e / ea_e) * ea_pxx * (1 + us_trm + us_trm_ea) * us_mm_sh_ea * [1 + us_xi_mm*(log(us_mm_sh_ea)-log(us_mm_sh_ea{-1})) - us_rdf*(log(us_mm_sh_ea{+1})-log(us_mm_sh_ea))] !! us_omega_ea * us_pmm = (us_e / ea_e) * ea_pxx * (1 + us_trm + us_trm_ea) * us_mm_sh_ea;
        
            "Demand for imports from [rw] in total [us] non-commodity imports"
            us_omega_rw * us_pmm = (us_e / rw_e) * rw_pxx * (1 + us_trm + us_trm_rw) * us_mm_sh_rw * [1 + us_xi_mm*(log(us_mm_sh_rw)-log(us_mm_sh_rw{-1})) - us_rdf*(log(us_mm_sh_rw{+1})-log(us_mm_sh_rw))] !! us_omega_rw * us_pmm = (us_e / rw_e) * rw_pxx * (1 + us_trm + us_trm_rw) * us_mm_sh_rw;
        
        us_fob_pmm = + (us_e / cn_e) * cn_pxx * us_mm_sh_cn + (us_e / ea_e) * ea_pxx * us_mm_sh_ea + (us_e / rw_e) * rw_pxx * us_mm_sh_rw ; 
    
        "Assembly of total non-commodity imports"
        1 = 1 * (ea_mm_sh_cn / ea_omega_cn)^ea_omega_cn * (ea_mm_sh_rw / ea_omega_rw)^ea_omega_rw * (ea_mm_sh_us / ea_omega_us)^ea_omega_us ;


            "Demand for imports from [cn] in total [ea] non-commodity imports"
            ea_omega_cn * ea_pmm = (ea_e / cn_e) * cn_pxx * (1 + ea_trm + ea_trm_cn) * ea_mm_sh_cn * [1 + ea_xi_mm*(log(ea_mm_sh_cn)-log(ea_mm_sh_cn{-1})) - ea_rdf*(log(ea_mm_sh_cn{+1})-log(ea_mm_sh_cn))] !! ea_omega_cn * ea_pmm = (ea_e / cn_e) * cn_pxx * (1 + ea_trm + ea_trm_cn) * ea_mm_sh_cn;
        
            "Demand for imports from [rw] in total [ea] non-commodity imports"
            ea_omega_rw * ea_pmm = (ea_e / rw_e) * rw_pxx * (1 + ea_trm + ea_trm_rw) * ea_mm_sh_rw * [1 + ea_xi_mm*(log(ea_mm_sh_rw)-log(ea_mm_sh_rw{-1})) - ea_rdf*(log(ea_mm_sh_rw{+1})-log(ea_mm_sh_rw))] !! ea_omega_rw * ea_pmm = (ea_e / rw_e) * rw_pxx * (1 + ea_trm + ea_trm_rw) * ea_mm_sh_rw;
        
            "Demand for imports from [us] in total [ea] non-commodity imports"
            ea_omega_us * ea_pmm = (ea_e / us_e) * us_pxx * (1 + ea_trm + ea_trm_us) * ea_mm_sh_us * [1 + ea_xi_mm*(log(ea_mm_sh_us)-log(ea_mm_sh_us{-1})) - ea_rdf*(log(ea_mm_sh_us{+1})-log(ea_mm_sh_us))] !! ea_omega_us * ea_pmm = (ea_e / us_e) * us_pxx * (1 + ea_trm + ea_trm_us) * ea_mm_sh_us;
        
        ea_fob_pmm = + (ea_e / cn_e) * cn_pxx * ea_mm_sh_cn + (ea_e / rw_e) * rw_pxx * ea_mm_sh_rw + (ea_e / us_e) * us_pxx * ea_mm_sh_us ; 
    
        "Assembly of total non-commodity imports"
        1 = 1 * (cn_mm_sh_ea / cn_omega_ea)^cn_omega_ea * (cn_mm_sh_rw / cn_omega_rw)^cn_omega_rw * (cn_mm_sh_us / cn_omega_us)^cn_omega_us ;


            "Demand for imports from [ea] in total [cn] non-commodity imports"
            cn_omega_ea * cn_pmm = (cn_e / ea_e) * ea_pxx * (1 + cn_trm + cn_trm_ea) * cn_mm_sh_ea * [1 + cn_xi_mm*(log(cn_mm_sh_ea)-log(cn_mm_sh_ea{-1})) - cn_rdf*(log(cn_mm_sh_ea{+1})-log(cn_mm_sh_ea))] !! cn_omega_ea * cn_pmm = (cn_e / ea_e) * ea_pxx * (1 + cn_trm + cn_trm_ea) * cn_mm_sh_ea;
        
            "Demand for imports from [rw] in total [cn] non-commodity imports"
            cn_omega_rw * cn_pmm = (cn_e / rw_e) * rw_pxx * (1 + cn_trm + cn_trm_rw) * cn_mm_sh_rw * [1 + cn_xi_mm*(log(cn_mm_sh_rw)-log(cn_mm_sh_rw{-1})) - cn_rdf*(log(cn_mm_sh_rw{+1})-log(cn_mm_sh_rw))] !! cn_omega_rw * cn_pmm = (cn_e / rw_e) * rw_pxx * (1 + cn_trm + cn_trm_rw) * cn_mm_sh_rw;
        
            "Demand for imports from [us] in total [cn] non-commodity imports"
            cn_omega_us * cn_pmm = (cn_e / us_e) * us_pxx * (1 + cn_trm + cn_trm_us) * cn_mm_sh_us * [1 + cn_xi_mm*(log(cn_mm_sh_us)-log(cn_mm_sh_us{-1})) - cn_rdf*(log(cn_mm_sh_us{+1})-log(cn_mm_sh_us))] !! cn_omega_us * cn_pmm = (cn_e / us_e) * us_pxx * (1 + cn_trm + cn_trm_us) * cn_mm_sh_us;
        
        cn_fob_pmm = + (cn_e / ea_e) * ea_pxx * cn_mm_sh_ea + (cn_e / rw_e) * rw_pxx * cn_mm_sh_rw + (cn_e / us_e) * us_pxx * cn_mm_sh_us ; 
    
        "Assembly of total non-commodity imports"
        1 = 1 * (rw_mm_sh_cn / rw_omega_cn)^rw_omega_cn * (rw_mm_sh_ea / rw_omega_ea)^rw_omega_ea * (rw_mm_sh_us / rw_omega_us)^rw_omega_us ;


            "Demand for imports from [cn] in total [rw] non-commodity imports"
            rw_omega_cn * rw_pmm = (rw_e / cn_e) * cn_pxx * (1 + rw_trm + rw_trm_cn) * rw_mm_sh_cn * [1 + rw_xi_mm*(log(rw_mm_sh_cn)-log(rw_mm_sh_cn{-1})) - rw_rdf*(log(rw_mm_sh_cn{+1})-log(rw_mm_sh_cn))] !! rw_omega_cn * rw_pmm = (rw_e / cn_e) * cn_pxx * (1 + rw_trm + rw_trm_cn) * rw_mm_sh_cn;
        
            "Demand for imports from [ea] in total [rw] non-commodity imports"
            rw_omega_ea * rw_pmm = (rw_e / ea_e) * ea_pxx * (1 + rw_trm + rw_trm_ea) * rw_mm_sh_ea * [1 + rw_xi_mm*(log(rw_mm_sh_ea)-log(rw_mm_sh_ea{-1})) - rw_rdf*(log(rw_mm_sh_ea{+1})-log(rw_mm_sh_ea))] !! rw_omega_ea * rw_pmm = (rw_e / ea_e) * ea_pxx * (1 + rw_trm + rw_trm_ea) * rw_mm_sh_ea;
        
            "Demand for imports from [us] in total [rw] non-commodity imports"
            rw_omega_us * rw_pmm = (rw_e / us_e) * us_pxx * (1 + rw_trm + rw_trm_us) * rw_mm_sh_us * [1 + rw_xi_mm*(log(rw_mm_sh_us)-log(rw_mm_sh_us{-1})) - rw_rdf*(log(rw_mm_sh_us{+1})-log(rw_mm_sh_us))] !! rw_omega_us * rw_pmm = (rw_e / us_e) * us_pxx * (1 + rw_trm + rw_trm_us) * rw_mm_sh_us;
        
        rw_fob_pmm = + (rw_e / cn_e) * cn_pxx * rw_mm_sh_cn + (rw_e / ea_e) * ea_pxx * rw_mm_sh_ea + (rw_e / us_e) * us_pxx * rw_mm_sh_us ; 


        !variables
            "Area specific import tariff rate" us_trm_cn

        !shocks
            "Shock to area specific import tariff rate" us_shk_trm_cn

        !parameters(:trade :steady)
            "S/S Area specific import tariff rate !! $\mathit{trm}_{\mathrm{cn},\ss}$" us_ss_trm_cn

        !parameters(:trade :dynamic)
            "A/E Area specific import tariff rate !! $\rho_{trm,\mathrm{cn}}$" us_rho_trm_cn

        !equations
            us_trm_cn = us_rho_trm_cn * us_trm_cn{-1} + (1 - us_rho_trm_cn) * us_ss_trm_cn + us_shk_trm_cn !! us_trm_cn = us_ss_trm_cn;
    
        !variables
            "Area specific import tariff rate" us_trm_ea

        !shocks
            "Shock to area specific import tariff rate" us_shk_trm_ea

        !parameters(:trade :steady)
            "S/S Area specific import tariff rate !! $\mathit{trm}_{\mathrm{ea},\ss}$" us_ss_trm_ea

        !parameters(:trade :dynamic)
            "A/E Area specific import tariff rate !! $\rho_{trm,\mathrm{ea}}$" us_rho_trm_ea

        !equations
            us_trm_ea = us_rho_trm_ea * us_trm_ea{-1} + (1 - us_rho_trm_ea) * us_ss_trm_ea + us_shk_trm_ea !! us_trm_ea = us_ss_trm_ea;
    
        !variables
            "Area specific import tariff rate" us_trm_rw

        !shocks
            "Shock to area specific import tariff rate" us_shk_trm_rw

        !parameters(:trade :steady)
            "S/S Area specific import tariff rate !! $\mathit{trm}_{\mathrm{rw},\ss}$" us_ss_trm_rw

        !parameters(:trade :dynamic)
            "A/E Area specific import tariff rate !! $\rho_{trm,\mathrm{rw}}$" us_rho_trm_rw

        !equations
            us_trm_rw = us_rho_trm_rw * us_trm_rw{-1} + (1 - us_rho_trm_rw) * us_ss_trm_rw + us_shk_trm_rw !! us_trm_rw = us_ss_trm_rw;


        !variables
            "Area specific import tariff rate" ea_trm_cn

        !shocks
            "Shock to area specific import tariff rate" ea_shk_trm_cn

        !parameters(:trade :steady)
            "S/S Area specific import tariff rate !! $\mathit{trm}_{\mathrm{cn},\ss}$" ea_ss_trm_cn

        !parameters(:trade :dynamic)
            "A/E Area specific import tariff rate !! $\rho_{trm,\mathrm{cn}}$" ea_rho_trm_cn

        !equations
            ea_trm_cn = ea_rho_trm_cn * ea_trm_cn{-1} + (1 - ea_rho_trm_cn) * ea_ss_trm_cn + ea_shk_trm_cn !! ea_trm_cn = ea_ss_trm_cn;
    
        !variables
            "Area specific import tariff rate" ea_trm_rw

        !shocks
            "Shock to area specific import tariff rate" ea_shk_trm_rw

        !parameters(:trade :steady)
            "S/S Area specific import tariff rate !! $\mathit{trm}_{\mathrm{rw},\ss}$" ea_ss_trm_rw

        !parameters(:trade :dynamic)
            "A/E Area specific import tariff rate !! $\rho_{trm,\mathrm{rw}}$" ea_rho_trm_rw

        !equations
            ea_trm_rw = ea_rho_trm_rw * ea_trm_rw{-1} + (1 - ea_rho_trm_rw) * ea_ss_trm_rw + ea_shk_trm_rw !! ea_trm_rw = ea_ss_trm_rw;
    
        !variables
            "Area specific import tariff rate" ea_trm_us

        !shocks
            "Shock to area specific import tariff rate" ea_shk_trm_us

        !parameters(:trade :steady)
            "S/S Area specific import tariff rate !! $\mathit{trm}_{\mathrm{us},\ss}$" ea_ss_trm_us

        !parameters(:trade :dynamic)
            "A/E Area specific import tariff rate !! $\rho_{trm,\mathrm{us}}$" ea_rho_trm_us

        !equations
            ea_trm_us = ea_rho_trm_us * ea_trm_us{-1} + (1 - ea_rho_trm_us) * ea_ss_trm_us + ea_shk_trm_us !! ea_trm_us = ea_ss_trm_us;


        !variables
            "Area specific import tariff rate" cn_trm_ea

        !shocks
            "Shock to area specific import tariff rate" cn_shk_trm_ea

        !parameters(:trade :steady)
            "S/S Area specific import tariff rate !! $\mathit{trm}_{\mathrm{ea},\ss}$" cn_ss_trm_ea

        !parameters(:trade :dynamic)
            "A/E Area specific import tariff rate !! $\rho_{trm,\mathrm{ea}}$" cn_rho_trm_ea

        !equations
            cn_trm_ea = cn_rho_trm_ea * cn_trm_ea{-1} + (1 - cn_rho_trm_ea) * cn_ss_trm_ea + cn_shk_trm_ea !! cn_trm_ea = cn_ss_trm_ea;
    
        !variables
            "Area specific import tariff rate" cn_trm_rw

        !shocks
            "Shock to area specific import tariff rate" cn_shk_trm_rw

        !parameters(:trade :steady)
            "S/S Area specific import tariff rate !! $\mathit{trm}_{\mathrm{rw},\ss}$" cn_ss_trm_rw

        !parameters(:trade :dynamic)
            "A/E Area specific import tariff rate !! $\rho_{trm,\mathrm{rw}}$" cn_rho_trm_rw

        !equations
            cn_trm_rw = cn_rho_trm_rw * cn_trm_rw{-1} + (1 - cn_rho_trm_rw) * cn_ss_trm_rw + cn_shk_trm_rw !! cn_trm_rw = cn_ss_trm_rw;
    
        !variables
            "Area specific import tariff rate" cn_trm_us

        !shocks
            "Shock to area specific import tariff rate" cn_shk_trm_us

        !parameters(:trade :steady)
            "S/S Area specific import tariff rate !! $\mathit{trm}_{\mathrm{us},\ss}$" cn_ss_trm_us

        !parameters(:trade :dynamic)
            "A/E Area specific import tariff rate !! $\rho_{trm,\mathrm{us}}$" cn_rho_trm_us

        !equations
            cn_trm_us = cn_rho_trm_us * cn_trm_us{-1} + (1 - cn_rho_trm_us) * cn_ss_trm_us + cn_shk_trm_us !! cn_trm_us = cn_ss_trm_us;


        !variables
            "Area specific import tariff rate" rw_trm_cn

        !shocks
            "Shock to area specific import tariff rate" rw_shk_trm_cn

        !parameters(:trade :steady)
            "S/S Area specific import tariff rate !! $\mathit{trm}_{\mathrm{cn},\ss}$" rw_ss_trm_cn

        !parameters(:trade :dynamic)
            "A/E Area specific import tariff rate !! $\rho_{trm,\mathrm{cn}}$" rw_rho_trm_cn

        !equations
            rw_trm_cn = rw_rho_trm_cn * rw_trm_cn{-1} + (1 - rw_rho_trm_cn) * rw_ss_trm_cn + rw_shk_trm_cn !! rw_trm_cn = rw_ss_trm_cn;
    
        !variables
            "Area specific import tariff rate" rw_trm_ea

        !shocks
            "Shock to area specific import tariff rate" rw_shk_trm_ea

        !parameters(:trade :steady)
            "S/S Area specific import tariff rate !! $\mathit{trm}_{\mathrm{ea},\ss}$" rw_ss_trm_ea

        !parameters(:trade :dynamic)
            "A/E Area specific import tariff rate !! $\rho_{trm,\mathrm{ea}}$" rw_rho_trm_ea

        !equations
            rw_trm_ea = rw_rho_trm_ea * rw_trm_ea{-1} + (1 - rw_rho_trm_ea) * rw_ss_trm_ea + rw_shk_trm_ea !! rw_trm_ea = rw_ss_trm_ea;
    
        !variables
            "Area specific import tariff rate" rw_trm_us

        !shocks
            "Shock to area specific import tariff rate" rw_shk_trm_us

        !parameters(:trade :steady)
            "S/S Area specific import tariff rate !! $\mathit{trm}_{\mathrm{us},\ss}$" rw_ss_trm_us

        !parameters(:trade :dynamic)
            "A/E Area specific import tariff rate !! $\rho_{trm,\mathrm{us}}$" rw_rho_trm_us

        !equations
            rw_trm_us = rw_rho_trm_us * rw_trm_us{-1} + (1 - rw_rho_trm_us) * rw_ss_trm_us + rw_shk_trm_us !! rw_trm_us = rw_ss_trm_us;


!postprocessor


            "Imports from [cn] to [us]"
            us_mm_cn = us_mm_sh_cn * us_mm;
        
            "Imports from [ea] to [us]"
            us_mm_ea = us_mm_sh_ea * us_mm;
        
            "Imports from [rw] to [us]"
            us_mm_rw = us_mm_sh_rw * us_mm;


            "Imports from [cn] to [ea]"
            ea_mm_cn = ea_mm_sh_cn * ea_mm;
        
            "Imports from [rw] to [ea]"
            ea_mm_rw = ea_mm_sh_rw * ea_mm;
        
            "Imports from [us] to [ea]"
            ea_mm_us = ea_mm_sh_us * ea_mm;


            "Imports from [ea] to [cn]"
            cn_mm_ea = cn_mm_sh_ea * cn_mm;
        
            "Imports from [rw] to [cn]"
            cn_mm_rw = cn_mm_sh_rw * cn_mm;
        
            "Imports from [us] to [cn]"
            cn_mm_us = cn_mm_sh_us * cn_mm;


            "Imports from [cn] to [rw]"
            rw_mm_cn = rw_mm_sh_cn * rw_mm;
        
            "Imports from [ea] to [rw]"
            rw_mm_ea = rw_mm_sh_ea * rw_mm;
        
            "Imports from [us] to [rw]"
            rw_mm_us = rw_mm_sh_us * rw_mm;


!log-variables !all-but


!parameters(:finance :steady)


            "Corporate equity portfolio share !! $\phi_\mathrm{us}$" us_phi_us
        
            "Corporate equity portfolio share !! $\phi_\mathrm{ea}$" us_phi_ea
        
            "Corporate equity portfolio share !! $\phi_\mathrm{cn}$" us_phi_cn
        
            "Corporate equity portfolio share !! $\phi_\mathrm{rw}$" us_phi_rw


            "Corporate equity portfolio share !! $\phi_\mathrm{us}$" ea_phi_us
        
            "Corporate equity portfolio share !! $\phi_\mathrm{ea}$" ea_phi_ea
        
            "Corporate equity portfolio share !! $\phi_\mathrm{cn}$" ea_phi_cn
        
            "Corporate equity portfolio share !! $\phi_\mathrm{rw}$" ea_phi_rw


            "Corporate equity portfolio share !! $\phi_\mathrm{us}$" cn_phi_us
        
            "Corporate equity portfolio share !! $\phi_\mathrm{ea}$" cn_phi_ea
        
            "Corporate equity portfolio share !! $\phi_\mathrm{cn}$" cn_phi_cn
        
            "Corporate equity portfolio share !! $\phi_\mathrm{rw}$" cn_phi_rw


            "Corporate equity portfolio share !! $\phi_\mathrm{us}$" rw_phi_us
        
            "Corporate equity portfolio share !! $\phi_\mathrm{ea}$" rw_phi_ea
        
            "Corporate equity portfolio share !! $\phi_\mathrm{cn}$" rw_phi_cn
        
            "Corporate equity portfolio share !! $\phi_\mathrm{rw}$" rw_phi_rw


!parameters(:finance :dynamic)

    
        "Forward capital adjustment cost parameter !! $\xi_k$" us_xi_k
    
        "Forward capital adjustment cost parameter !! $\xi_k$" ea_xi_k
    
        "Forward capital adjustment cost parameter !! $\xi_k$" cn_xi_k
    
        "Forward capital adjustment cost parameter !! $\xi_k$" rw_xi_k


!equations

    
        "Average arbitrage-free condition"
        
            + us_phi_us * ( - us_beta * us_vh{+1} * us_rh * us_pk * us_e / us_e - us_vh * us_xi_k * us_pk * [ log(us_k) - log(us_k{+1}/&us_roc_k) ] + us_vh * us_pu * us_u * us_e / us_e + gg_zk * us_zk * us_beta * us_vh{+1} * (1-us_delta) * us_pk{+1} * us_e{+1} / us_e{+1} )         
            + ea_phi_us * ( - ea_beta * ea_vh{+1} * ea_rh * us_pk * ea_e / us_e - ea_vh * us_xi_k * us_pk * [ log(us_k) - log(us_k{+1}/&us_roc_k) ] + ea_vh * us_pu * us_u * ea_e / us_e + gg_zk * ea_zk * ea_beta * ea_vh{+1} * (1-us_delta) * us_pk{+1} * ea_e{+1} / us_e{+1} )         
            + cn_phi_us * ( - cn_beta * cn_vh{+1} * cn_rh * us_pk * cn_e / us_e - cn_vh * us_xi_k * us_pk * [ log(us_k) - log(us_k{+1}/&us_roc_k) ] + cn_vh * us_pu * us_u * cn_e / us_e + gg_zk * cn_zk * cn_beta * cn_vh{+1} * (1-us_delta) * us_pk{+1} * cn_e{+1} / us_e{+1} )         
            + rw_phi_us * ( - rw_beta * rw_vh{+1} * rw_rh * us_pk * rw_e / us_e - rw_vh * us_xi_k * us_pk * [ log(us_k) - log(us_k{+1}/&us_roc_k) ] + rw_vh * us_pu * us_u * rw_e / us_e + gg_zk * rw_zk * rw_beta * rw_vh{+1} * (1-us_delta) * us_pk{+1} * rw_e{+1} / us_e{+1} )         
        ;
    
        "Average arbitrage-free condition"
        
            + us_phi_ea * ( - us_beta * us_vh{+1} * us_rh * ea_pk * us_e / ea_e - us_vh * ea_xi_k * ea_pk * [ log(ea_k) - log(ea_k{+1}/&ea_roc_k) ] + us_vh * ea_pu * ea_u * us_e / ea_e + gg_zk * us_zk * us_beta * us_vh{+1} * (1-ea_delta) * ea_pk{+1} * us_e{+1} / ea_e{+1} )         
            + ea_phi_ea * ( - ea_beta * ea_vh{+1} * ea_rh * ea_pk * ea_e / ea_e - ea_vh * ea_xi_k * ea_pk * [ log(ea_k) - log(ea_k{+1}/&ea_roc_k) ] + ea_vh * ea_pu * ea_u * ea_e / ea_e + gg_zk * ea_zk * ea_beta * ea_vh{+1} * (1-ea_delta) * ea_pk{+1} * ea_e{+1} / ea_e{+1} )         
            + cn_phi_ea * ( - cn_beta * cn_vh{+1} * cn_rh * ea_pk * cn_e / ea_e - cn_vh * ea_xi_k * ea_pk * [ log(ea_k) - log(ea_k{+1}/&ea_roc_k) ] + cn_vh * ea_pu * ea_u * cn_e / ea_e + gg_zk * cn_zk * cn_beta * cn_vh{+1} * (1-ea_delta) * ea_pk{+1} * cn_e{+1} / ea_e{+1} )         
            + rw_phi_ea * ( - rw_beta * rw_vh{+1} * rw_rh * ea_pk * rw_e / ea_e - rw_vh * ea_xi_k * ea_pk * [ log(ea_k) - log(ea_k{+1}/&ea_roc_k) ] + rw_vh * ea_pu * ea_u * rw_e / ea_e + gg_zk * rw_zk * rw_beta * rw_vh{+1} * (1-ea_delta) * ea_pk{+1} * rw_e{+1} / ea_e{+1} )         
        ;
    
        "Average arbitrage-free condition"
        
            + us_phi_cn * ( - us_beta * us_vh{+1} * us_rh * cn_pk * us_e / cn_e - us_vh * cn_xi_k * cn_pk * [ log(cn_k) - log(cn_k{+1}/&cn_roc_k) ] + us_vh * cn_pu * cn_u * us_e / cn_e + gg_zk * us_zk * us_beta * us_vh{+1} * (1-cn_delta) * cn_pk{+1} * us_e{+1} / cn_e{+1} )         
            + ea_phi_cn * ( - ea_beta * ea_vh{+1} * ea_rh * cn_pk * ea_e / cn_e - ea_vh * cn_xi_k * cn_pk * [ log(cn_k) - log(cn_k{+1}/&cn_roc_k) ] + ea_vh * cn_pu * cn_u * ea_e / cn_e + gg_zk * ea_zk * ea_beta * ea_vh{+1} * (1-cn_delta) * cn_pk{+1} * ea_e{+1} / cn_e{+1} )         
            + cn_phi_cn * ( - cn_beta * cn_vh{+1} * cn_rh * cn_pk * cn_e / cn_e - cn_vh * cn_xi_k * cn_pk * [ log(cn_k) - log(cn_k{+1}/&cn_roc_k) ] + cn_vh * cn_pu * cn_u * cn_e / cn_e + gg_zk * cn_zk * cn_beta * cn_vh{+1} * (1-cn_delta) * cn_pk{+1} * cn_e{+1} / cn_e{+1} )         
            + rw_phi_cn * ( - rw_beta * rw_vh{+1} * rw_rh * cn_pk * rw_e / cn_e - rw_vh * cn_xi_k * cn_pk * [ log(cn_k) - log(cn_k{+1}/&cn_roc_k) ] + rw_vh * cn_pu * cn_u * rw_e / cn_e + gg_zk * rw_zk * rw_beta * rw_vh{+1} * (1-cn_delta) * cn_pk{+1} * rw_e{+1} / cn_e{+1} )         
        ;
    
        "Average arbitrage-free condition"
        
            + us_phi_rw * ( - us_beta * us_vh{+1} * us_rh * rw_pk * us_e / rw_e - us_vh * rw_xi_k * rw_pk * [ log(rw_k) - log(rw_k{+1}/&rw_roc_k) ] + us_vh * rw_pu * rw_u * us_e / rw_e + gg_zk * us_zk * us_beta * us_vh{+1} * (1-rw_delta) * rw_pk{+1} * us_e{+1} / rw_e{+1} )         
            + ea_phi_rw * ( - ea_beta * ea_vh{+1} * ea_rh * rw_pk * ea_e / rw_e - ea_vh * rw_xi_k * rw_pk * [ log(rw_k) - log(rw_k{+1}/&rw_roc_k) ] + ea_vh * rw_pu * rw_u * ea_e / rw_e + gg_zk * ea_zk * ea_beta * ea_vh{+1} * (1-rw_delta) * rw_pk{+1} * ea_e{+1} / rw_e{+1} )         
            + cn_phi_rw * ( - cn_beta * cn_vh{+1} * cn_rh * rw_pk * cn_e / rw_e - cn_vh * rw_xi_k * rw_pk * [ log(rw_k) - log(rw_k{+1}/&rw_roc_k) ] + cn_vh * rw_pu * rw_u * cn_e / rw_e + gg_zk * cn_zk * cn_beta * cn_vh{+1} * (1-rw_delta) * rw_pk{+1} * cn_e{+1} / rw_e{+1} )         
            + rw_phi_rw * ( - rw_beta * rw_vh{+1} * rw_rh * rw_pk * rw_e / rw_e - rw_vh * rw_xi_k * rw_pk * [ log(rw_k) - log(rw_k{+1}/&rw_roc_k) ] + rw_vh * rw_pu * rw_u * rw_e / rw_e + gg_zk * rw_zk * rw_beta * rw_vh{+1} * (1-rw_delta) * rw_pk{+1} * rw_e{+1} / rw_e{+1} )         
        ;


        "BOP FA corporate equity transactions to GDP ratio"
        us_bpfeq_to_ngdp * us_ngdp =         
            + us_phi_us * us_e / us_e * ( + (1 - us_delta) * us_pk * us_k{-1} - us_pk * us_k ) - us_phi_us * ( + (1 - us_delta) * us_pk * us_k{-1} - us_pk * us_k )         
            + us_phi_ea * us_e / ea_e * ( + (1 - ea_delta) * ea_pk * ea_k{-1} - ea_pk * ea_k ) - ea_phi_us * ( + (1 - us_delta) * us_pk * us_k{-1} - us_pk * us_k )         
            + us_phi_cn * us_e / cn_e * ( + (1 - cn_delta) * cn_pk * cn_k{-1} - cn_pk * cn_k ) - cn_phi_us * ( + (1 - us_delta) * us_pk * us_k{-1} - us_pk * us_k )         
            + us_phi_rw * us_e / rw_e * ( + (1 - rw_delta) * rw_pk * rw_k{-1} - rw_pk * rw_k ) - rw_phi_us * ( + (1 - us_delta) * us_pk * us_k{-1} - us_pk * us_k )         
        ;

        "BOP CA corporate equity primary income to GDP ratio"
        us_bpceq_to_ngdp * us_ngdp =         
            + us_phi_us * us_e / us_e * ( + us_pu * us_uk ) - us_phi_us * ( + us_pu * us_uk )         
            + us_phi_ea * us_e / ea_e * ( + ea_pu * ea_uk ) - ea_phi_us * ( + us_pu * us_uk )         
            + us_phi_cn * us_e / cn_e * ( + cn_pu * cn_uk ) - cn_phi_us * ( + us_pu * us_uk )         
            + us_phi_rw * us_e / rw_e * ( + rw_pu * rw_uk ) - rw_phi_us * ( + us_pu * us_uk )         
        ;
    
        "BOP FA corporate equity transactions to GDP ratio"
        ea_bpfeq_to_ngdp * ea_ngdp =         
            + ea_phi_us * ea_e / us_e * ( + (1 - us_delta) * us_pk * us_k{-1} - us_pk * us_k ) - us_phi_ea * ( + (1 - ea_delta) * ea_pk * ea_k{-1} - ea_pk * ea_k )         
            + ea_phi_ea * ea_e / ea_e * ( + (1 - ea_delta) * ea_pk * ea_k{-1} - ea_pk * ea_k ) - ea_phi_ea * ( + (1 - ea_delta) * ea_pk * ea_k{-1} - ea_pk * ea_k )         
            + ea_phi_cn * ea_e / cn_e * ( + (1 - cn_delta) * cn_pk * cn_k{-1} - cn_pk * cn_k ) - cn_phi_ea * ( + (1 - ea_delta) * ea_pk * ea_k{-1} - ea_pk * ea_k )         
            + ea_phi_rw * ea_e / rw_e * ( + (1 - rw_delta) * rw_pk * rw_k{-1} - rw_pk * rw_k ) - rw_phi_ea * ( + (1 - ea_delta) * ea_pk * ea_k{-1} - ea_pk * ea_k )         
        ;

        "BOP CA corporate equity primary income to GDP ratio"
        ea_bpceq_to_ngdp * ea_ngdp =         
            + ea_phi_us * ea_e / us_e * ( + us_pu * us_uk ) - us_phi_ea * ( + ea_pu * ea_uk )         
            + ea_phi_ea * ea_e / ea_e * ( + ea_pu * ea_uk ) - ea_phi_ea * ( + ea_pu * ea_uk )         
            + ea_phi_cn * ea_e / cn_e * ( + cn_pu * cn_uk ) - cn_phi_ea * ( + ea_pu * ea_uk )         
            + ea_phi_rw * ea_e / rw_e * ( + rw_pu * rw_uk ) - rw_phi_ea * ( + ea_pu * ea_uk )         
        ;
    
        "BOP FA corporate equity transactions to GDP ratio"
        cn_bpfeq_to_ngdp * cn_ngdp =         
            + cn_phi_us * cn_e / us_e * ( + (1 - us_delta) * us_pk * us_k{-1} - us_pk * us_k ) - us_phi_cn * ( + (1 - cn_delta) * cn_pk * cn_k{-1} - cn_pk * cn_k )         
            + cn_phi_ea * cn_e / ea_e * ( + (1 - ea_delta) * ea_pk * ea_k{-1} - ea_pk * ea_k ) - ea_phi_cn * ( + (1 - cn_delta) * cn_pk * cn_k{-1} - cn_pk * cn_k )         
            + cn_phi_cn * cn_e / cn_e * ( + (1 - cn_delta) * cn_pk * cn_k{-1} - cn_pk * cn_k ) - cn_phi_cn * ( + (1 - cn_delta) * cn_pk * cn_k{-1} - cn_pk * cn_k )         
            + cn_phi_rw * cn_e / rw_e * ( + (1 - rw_delta) * rw_pk * rw_k{-1} - rw_pk * rw_k ) - rw_phi_cn * ( + (1 - cn_delta) * cn_pk * cn_k{-1} - cn_pk * cn_k )         
        ;

        "BOP CA corporate equity primary income to GDP ratio"
        cn_bpceq_to_ngdp * cn_ngdp =         
            + cn_phi_us * cn_e / us_e * ( + us_pu * us_uk ) - us_phi_cn * ( + cn_pu * cn_uk )         
            + cn_phi_ea * cn_e / ea_e * ( + ea_pu * ea_uk ) - ea_phi_cn * ( + cn_pu * cn_uk )         
            + cn_phi_cn * cn_e / cn_e * ( + cn_pu * cn_uk ) - cn_phi_cn * ( + cn_pu * cn_uk )         
            + cn_phi_rw * cn_e / rw_e * ( + rw_pu * rw_uk ) - rw_phi_cn * ( + cn_pu * cn_uk )         
        ;
    
        "BOP FA corporate equity transactions to GDP ratio"
        rw_bpfeq_to_ngdp * rw_ngdp =         
            + rw_phi_us * rw_e / us_e * ( + (1 - us_delta) * us_pk * us_k{-1} - us_pk * us_k ) - us_phi_rw * ( + (1 - rw_delta) * rw_pk * rw_k{-1} - rw_pk * rw_k )         
            + rw_phi_ea * rw_e / ea_e * ( + (1 - ea_delta) * ea_pk * ea_k{-1} - ea_pk * ea_k ) - ea_phi_rw * ( + (1 - rw_delta) * rw_pk * rw_k{-1} - rw_pk * rw_k )         
            + rw_phi_cn * rw_e / cn_e * ( + (1 - cn_delta) * cn_pk * cn_k{-1} - cn_pk * cn_k ) - cn_phi_rw * ( + (1 - rw_delta) * rw_pk * rw_k{-1} - rw_pk * rw_k )         
            + rw_phi_rw * rw_e / rw_e * ( + (1 - rw_delta) * rw_pk * rw_k{-1} - rw_pk * rw_k ) - rw_phi_rw * ( + (1 - rw_delta) * rw_pk * rw_k{-1} - rw_pk * rw_k )         
        ;

        "BOP CA corporate equity primary income to GDP ratio"
        rw_bpceq_to_ngdp * rw_ngdp =         
            + rw_phi_us * rw_e / us_e * ( + us_pu * us_uk ) - us_phi_rw * ( + rw_pu * rw_uk )         
            + rw_phi_ea * rw_e / ea_e * ( + ea_pu * ea_uk ) - ea_phi_rw * ( + rw_pu * rw_uk )         
            + rw_phi_cn * rw_e / cn_e * ( + cn_pu * cn_uk ) - cn_phi_rw * ( + rw_pu * rw_uk )         
            + rw_phi_rw * rw_e / rw_e * ( + rw_pu * rw_uk ) - rw_phi_rw * ( + rw_pu * rw_uk )         
        ;


        "Value of corporate equity portfolio"
        us_kk = + us_phi_us * us_e / us_e * (us_pk * us_k) + us_phi_ea * us_e / ea_e * (ea_pk * ea_k) + us_phi_cn * us_e / cn_e * (cn_pk * cn_k) + us_phi_rw * us_e / rw_e * (rw_pk * rw_k) ;
    
        "Value of corporate equity portfolio"
        ea_kk = + ea_phi_us * ea_e / us_e * (us_pk * us_k) + ea_phi_ea * ea_e / ea_e * (ea_pk * ea_k) + ea_phi_cn * ea_e / cn_e * (cn_pk * cn_k) + ea_phi_rw * ea_e / rw_e * (rw_pk * rw_k) ;
    
        "Value of corporate equity portfolio"
        cn_kk = + cn_phi_us * cn_e / us_e * (us_pk * us_k) + cn_phi_ea * cn_e / ea_e * (ea_pk * ea_k) + cn_phi_cn * cn_e / cn_e * (cn_pk * cn_k) + cn_phi_rw * cn_e / rw_e * (rw_pk * rw_k) ;
    
        "Value of corporate equity portfolio"
        rw_kk = + rw_phi_us * rw_e / us_e * (us_pk * us_k) + rw_phi_ea * rw_e / ea_e * (ea_pk * ea_k) + rw_phi_cn * rw_e / cn_e * (cn_pk * cn_k) + rw_phi_rw * rw_e / rw_e * (rw_pk * rw_k) ;
